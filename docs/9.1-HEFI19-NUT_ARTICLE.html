<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.296">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Didier Brassard">
<meta name="author" content="Stéphanie Chevalier">
<meta name="dcterms.date" content="2023-08-03">

<title>Brassard and Chevalier, J Nutr 2023 - Relationship between adherence to the 2019 Canada’s Food Guide recommendations on healthy food choices and nutrient intakes in older adults</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Brassard and Chevalier, J Nutr 2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/didierbrassard/hefi2019_nutrient/blob/main/README.md" rel="" target="">
 <span class="menu-text">READ ME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./9.1-HEFI19-NUT_ARTICLE.html" rel="" target="" aria-current="page">
 <span class="menu-text">Manuscript</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./9.2-HEFI19-NUT_OSM.html" rel="" target="">
 <span class="menu-text">Supplemental material</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://osf.io/6na42/" rel="" target=""><i class="bi bi-database-fill" role="img">
</i> 
 <span class="menu-text">Access data</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="mailto:didier.brassard@mcgill.ca" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text">Email</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://twitter.com/didier_dtp" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text">Twitter</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#materials-and-methods" id="toc-materials-and-methods" class="nav-link" data-scroll-target="#materials-and-methods">Materials and Methods</a>
  <ul class="collapse">
  <li><a href="#study-design-and-participants" id="toc-study-design-and-participants" class="nav-link" data-scroll-target="#study-design-and-participants">Study Design and Participants</a></li>
  <li><a href="#data-collection-and-dietary-assessment" id="toc-data-collection-and-dietary-assessment" class="nav-link" data-scroll-target="#data-collection-and-dietary-assessment">Data Collection and Dietary Assessment</a>
  <ul class="collapse">
  <li><a href="#the-healthy-eating-food-index-hefi-2019" id="toc-the-healthy-eating-food-index-hefi-2019" class="nav-link" data-scroll-target="#the-healthy-eating-food-index-hefi-2019">The Healthy Eating Food Index (HEFI) 2019</a></li>
  <li><a href="#nutrient-intakes" id="toc-nutrient-intakes" class="nav-link" data-scroll-target="#nutrient-intakes">Nutrient intakes</a></li>
  </ul></li>
  <li><a href="#statistical-analyses" id="toc-statistical-analyses" class="nav-link" data-scroll-target="#statistical-analyses">Statistical Analyses</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#hefi-2019-score-and-dietary-constituents" id="toc-hefi-2019-score-and-dietary-constituents" class="nav-link" data-scroll-target="#hefi-2019-score-and-dietary-constituents">HEFI-2019 Score and Dietary Constituents</a></li>
  <li><a href="#prevalence-of-inadequate-nutrient-intake" id="toc-prevalence-of-inadequate-nutrient-intake" class="nav-link" data-scroll-target="#prevalence-of-inadequate-nutrient-intake">Prevalence of Inadequate Nutrient Intake</a></li>
  <li><a href="#relationship-between-the-hefi-2019-score-and-nutrient-intakes" id="toc-relationship-between-the-hefi-2019-score-and-nutrient-intakes" class="nav-link" data-scroll-target="#relationship-between-the-hefi-2019-score-and-nutrient-intakes">Relationship between the HEFI-2019 Score and Nutrient Intakes</a></li>
  <li><a href="#relationship-between-the-hefi-2019-score-and-nutrient-intake-inadequacy" id="toc-relationship-between-the-hefi-2019-score-and-nutrient-intake-inadequacy" class="nav-link" data-scroll-target="#relationship-between-the-hefi-2019-score-and-nutrient-intake-inadequacy">Relationship between the HEFI-2019 Score and Nutrient Intake Inadequacy</a>
  <ul class="collapse">
  <li><a href="#inadequate-nutrient-intakes" id="toc-inadequate-nutrient-intakes" class="nav-link" data-scroll-target="#inadequate-nutrient-intakes">Inadequate Nutrient Intakes</a></li>
  </ul></li>
  <li><a href="#adequate-intakes-for-fiber-and-potassium" id="toc-adequate-intakes-for-fiber-and-potassium" class="nav-link" data-scroll-target="#adequate-intakes-for-fiber-and-potassium">Adequate Intakes for Fiber and Potassium</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#acknowledgments" id="toc-acknowledgments" class="nav-link" data-scroll-target="#acknowledgments">Acknowledgments</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Relationship between adherence to the 2019 Canada’s Food Guide recommendations on healthy food choices and nutrient intakes in older adults</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Didier Brassard <a href="https://orcid.org/0000-0002-7064-3066" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            School of Human Nutrition, McGill University
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <p class="author">Stéphanie Chevalier <a href="https://orcid.org/0000-0002-8497-1570" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            School of Human Nutrition, McGill University
          </p>
        <p class="affiliation">
            Research Institute of the McGill University Health Centre
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 3, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                Markdown set-up                 #</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dpi =</span> <span class="dv">300</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">out.width =</span> <span class="st">"80%"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig.env =</span> <span class="st">"figure"</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig.align =</span> <span class="st">"center"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="do">## suppress scientific notation</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">9999</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="do">## file path </span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>()</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#              Relative file paths               #</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># create directory to save figures/table/data, if needed</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dir.exists</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Manuscript"</span>))<span class="sc">==</span><span class="cn">FALSE</span>){</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Manuscript"</span>))</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dir.exists</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"Results"</span>))<span class="sc">==</span><span class="cn">FALSE</span>){</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"Results"</span>))</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>ms_dir  <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Manuscript"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>res_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>,<span class="st">"Results"</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************** #</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Packages                      #</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************** #</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="do">## data management</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="do">## results presentation</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinytex)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MetBrewer)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************** #</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co">#                Common labels                    #</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************** #</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="do">### DRI groups</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>drig_list <span class="ot">&lt;-</span> </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>drig_label <span class="ot">&lt;-</span> </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">'Adults 65 y+'</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Males, 65 to 70 y'</span>,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Females, 65 to 70 y'</span>,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Males, 71 y+'</span>,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Females, 71 y+'</span>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>drig_plotlabel <span class="ot">&lt;-</span> </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">'12'</span><span class="ot">=</span><span class="st">'Males, 65 to 70 years'</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="st">'13'</span><span class="ot">=</span><span class="st">'Females, 65 to 70 years'</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="st">'14'</span><span class="ot">=</span><span class="st">'Males, 71 and older'</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="st">'15'</span><span class="ot">=</span><span class="st">'Females, 71 and older'</span>)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="do">### Nutrient variable names</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>varname_list <span class="ot">&lt;-</span> </span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">'pro'</span>,</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">'pro_kg'</span>,</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">'calcium'</span>,</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">'vit_d'</span>,</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">'iron'</span>,</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">'zinc'</span>,</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">'vit_b6'</span>,</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">'vit_b12'</span>,</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dfe'</span>,</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mg'</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">'pota'</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">'fibers'</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">'rae'</span>)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>label_list <span class="ot">&lt;-</span> </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">'Protein, g/d'</span>,</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Protein, g/kg/d'</span>,</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Calcium, mg/d'</span>,</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Vitamin D, mcg/d'</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Iron, mg/d'</span>,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Zinc, mg/d'</span>,</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Vitamin B6, mg/d'</span>,</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Vitamin B12, mcg/d'</span>,</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'Dietary folate equivalent, mcg/d',</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Folate, DFE/d'</span>,</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Magnesium, mg/d'</span>,</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Potassium, mg/d'</span>,</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Fiber, g/d'</span>,</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Vitamin A, RAE/d'</span> )</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>varlabel_data <span class="ot">&lt;-</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">varname=</span>varname_list,</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>             <span class="at">varnamelabel=</span>label_list)</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>varlabel_list <span class="ot">&lt;-</span> </span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">pro=</span><span class="st">'Protein, g/d'</span>,</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">pro_kg =</span> <span class="st">'Protein, g/kg/d'</span>,</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">calcium=</span><span class="st">'Calcium, mg/d'</span>,</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">vit_d=</span><span class="st">'Vitamin D, mcg/d'</span>,</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">iron=</span><span class="st">'Iron, mg/d'</span>,</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">zinc=</span><span class="st">'Zinc, mg/d'</span>,</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">vit_b6=</span><span class="st">'Vitamin B6, mg/d'</span>,</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">vit_b12=</span><span class="st">'Vitamin B12, mcg/d'</span>,</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>    <span class="co">#dfe='Dietary folate equivalent, mcg/d',</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">dfe=</span><span class="st">'Folate, DFE/d'</span>,</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">mg=</span><span class="st">'Magnesium, mg/d'</span>,</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">pota=</span><span class="st">'Potassium, mg/d'</span>,</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">fibers=</span><span class="st">'Fiber, g/d'</span>,</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">rae=</span><span class="st">'Vitamin A, RAE/d'</span>)</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>varlabeltidy_list <span class="ot">&lt;-</span> </span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>( <span class="at">pro=</span><span class="st">'Protein'</span>, </span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">pro_kg=</span><span class="st">'Protein'</span>, </span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">calcium=</span><span class="st">'Calcium'</span>, </span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">vit_d=</span><span class="st">'Vitamin D'</span>, </span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">iron=</span><span class="st">'Iron'</span>, </span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">zinc=</span><span class="st">'Zinc'</span>, </span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">vit_b6=</span><span class="st">'Vitamin B6'</span>, </span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">vit_b12=</span><span class="st">'Vitamin B12'</span>, </span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>    <span class="co">#dfe='Dietary folate equivalent', </span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">dfe=</span><span class="st">'Folate'</span>, </span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">mg=</span><span class="st">'Magnesium'</span>, </span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">pota=</span><span class="st">'Potassium'</span>, </span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">fibers=</span><span class="st">'Fiber'</span>,</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">rae=</span><span class="st">'Vitamin A'</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Functions                    #</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;tolower1&gt;: lower case,but only for first letter (works for 1 word)</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>  tolower1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">substr</span>(x, <span class="dv">1</span>, <span class="dv">1</span>) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">substr</span>(x, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x) </span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a> <span class="co"># alternative with many words:</span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a> <span class="co"># lapply(many_x,function(x) str_replace(x, "^\\w{1}", tolower) )</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;makeEstimate&gt; to format mean (SD) (within mutate step for example)</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>makeEstimate <span class="ot">&lt;-</span> <span class="cf">function</span>(est,var,<span class="at">rounding=</span><span class="fl">0.1</span>){</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>( scales<span class="sc">::</span><span class="fu">number</span>(est,<span class="at">accuracy =</span> rounding,<span class="at">big.mark=</span><span class="st">","</span>),<span class="st">" ("</span>,scales<span class="sc">::</span><span class="fu">number</span>(var,<span class="at">accuracy =</span> rounding,<span class="at">big.mark=</span><span class="st">","</span>,),<span class="st">")"</span>)</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;makeEstimateCI&gt; to format Estimate (95%CI) (within mutate step for example)</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>makeEstimateCI <span class="ot">&lt;-</span> <span class="cf">function</span>(est,lcl,ucl,<span class="at">sep=</span><span class="st">" to "</span>,<span class="at">numsep=</span><span class="st">","</span>,<span class="at">rounding=</span><span class="fl">0.1</span>){</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>( scales<span class="sc">::</span><span class="fu">number</span>(est,<span class="at">accuracy =</span> rounding,<span class="at">big.mark=</span>numsep),</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>        <span class="st">" ("</span>,scales<span class="sc">::</span><span class="fu">number</span>(lcl,<span class="at">accuracy =</span> rounding,<span class="at">big.mark=</span>numsep),</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>          sep,</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>        scales<span class="sc">::</span><span class="fu">number</span>(ucl,<span class="at">accuracy =</span> rounding,<span class="at">big.mark=</span>numsep),</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>          <span class="st">")"</span>)  </span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>make95ci <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">sep=</span><span class="st">", "</span>,<span class="at">rounding=</span><span class="fl">0.01</span>,<span class="at">reverse=</span><span class="dv">0</span>,<span class="at">add_suffix=</span><span class="st">""</span>){</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>  lcl <span class="ot">&lt;-</span> <span class="fu">paste0</span>(scales<span class="sc">::</span><span class="fu">number</span>(x<span class="sc">$</span>lcl95,<span class="at">accuracy=</span>rounding),add_suffix)</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>  ucl <span class="ot">&lt;-</span> <span class="fu">paste0</span>(scales<span class="sc">::</span><span class="fu">number</span>(x<span class="sc">$</span>ucl95,<span class="at">accuracy=</span>rounding),add_suffix)</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(reverse<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Regular ordering, estimate (LCL to UCL)</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>      <span class="fu">noquote</span>( <span class="fu">paste0</span>(lcl,sep,ucl) )</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reversed ordering, estimate (UCL to LCL)</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>      <span class="fu">noquote</span>( <span class="fu">paste0</span>(ucl,sep,lcl) )</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;slice_mc_t_out&gt; to import individual data point</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>slice_mc_t_out  <span class="ot">&lt;-</span> </span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(nutrient,nutrient_label){</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set seed for consistent selection</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1101</span>) <span class="co"># note: generated using &lt;https://www.random.org&gt; (range 1:5000) on 2023-07-27, first trial</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>  <span class="co"># import, sample obs | weight_nw_sumw_div, include id, return</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>  mc_sample <span class="ot">&lt;-</span> </span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>    haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">"NCI"</span>,<span class="fu">paste0</span>(<span class="st">"MCMC_"</span>,nutrient_label),<span class="st">"Model"</span>,<span class="st">"_usintake_mc_t_out0.sas7bdat"</span>),</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_select=</span><span class="fu">c</span>(adm_rno,drig,weight_nw_sumw_div,</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>                               HEFI2019_TOTAL_SCORE,{{nutrient}})) <span class="sc">|&gt;</span> </span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="co"># Better to use fixed sample size for consistency purpose</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weight_by =</span> weight_nw_sumw_div) <span class="sc">|&gt;</span> </span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>     <span class="at">pseudoid =</span> <span class="fu">row_number</span>()</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>weight_nw_sumw_div)</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mc_sample)</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a><span class="co"># Auxiliary functions to read MCMC data and calculate correlations</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Macros"</span>,<span class="st">"post_mcmc_auxiliary.R"</span>))</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a><span class="co">#              Style and formatting              #</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleveland dot plot - originally found on Stack Overflow, cant find the source </span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>theme_dotplotx <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>( <span class="do">## remove the vertical grid lines</span></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>() ,</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>() ,</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>    <span class="do">## explicitly set the horizontal lines (or they will disappear too)</span></span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">linetype =</span> <span class="dv">3</span>),</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.2</span>),<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.2</span>),<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>    <span class="do">## use a white backgrounsd</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">colour =</span> <span class="st">"grey20"</span>))</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a><span class="do">## GT Table style</span></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>  gtstyle <span class="ot">&lt;-</span> <span class="cf">function</span>(gtobject,<span class="at">footnote_marker=</span><span class="st">"numbers"</span>){</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>    gtobject <span class="sc">|&gt;</span></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>      gt<span class="sc">::</span><span class="fu">tab_style</span>(</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>        <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)  ),</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_row_groups</span>(<span class="at">groups =</span> <span class="fu">everything</span>())</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>      gt<span class="sc">::</span><span class="fu">opt_align_table_header</span>(<span class="st">"left"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>      gt<span class="sc">::</span><span class="fu">opt_footnote_marks</span>(<span class="at">marks=</span>footnote_marker)</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a><span class="do">## saving gt object vs. printing directly</span></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>  gtsave_select <span class="ot">&lt;-</span> <span class="cf">function</span>(object,label,docx){</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(docx <span class="sc">==</span> <span class="st">"Y"</span>){</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>  <span class="co"># save as docx</span></span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a> object <span class="sc">|&gt;</span></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>    gt<span class="sc">::</span><span class="fu">gtsave</span>(<span class="fu">file.path</span>(ms_dir,<span class="fu">paste0</span>(label,<span class="st">".docx"</span>)))</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print gt object directly</span></span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>  object</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>}  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="abstract" class="level1">
<h1>Abstract</h1>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#            Distribution of usual intakes for each nutrient              #</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define variables to keep in each distribution data</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>distrib_var <span class="ot">&lt;-</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"drig"</span>,<span class="st">"varname"</span>,<span class="st">"Mean"</span>,<span class="st">"StdDev"</span>,<span class="st">"Variance"</span>, <span class="fu">paste0</span>(<span class="st">"Pctile"</span>,<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">99</span>)))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#            Import nutrient distrib             #</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>distrib_pro <span class="ot">&lt;-</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_abs_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) <span class="sc">|&gt;</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_rel_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>distrib_cavitd <span class="ot">&lt;-</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcium</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_ca_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) <span class="sc">|&gt;</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vitamin D</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_vitd_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var))</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>distrib_miscA <span class="ot">&lt;-</span> </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iron</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  (haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_iron_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) <span class="sc">|&gt;</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Zinc</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_zinc_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) <span class="sc">|&gt;</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vitamin B6</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_b6_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) )  <span class="sc">|&gt;</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vitamin B12</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_b12_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>distrib_miscB <span class="ot">&lt;-</span> </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Folate</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  (haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_dfe_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) <span class="sc">|&gt;</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Magnesium</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_mg_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) <span class="sc">|&gt;</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fiber</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_fib_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) )  <span class="sc">|&gt;</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Potassium</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_pota_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) </span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>distrib_vita <span class="ot">&lt;-</span> </span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vitamin A (RAE)</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_rae_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="co">#            Append nutrient distrib             #</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>distrib_y <span class="ot">&lt;-</span> </span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(distrib_pro,distrib_cavitd,</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>        distrib_miscA,distrib_miscB,</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>        distrib_vita) <span class="sc">|&gt;</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename protein variable for consistency</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">ifelse</span>(varname<span class="sc">==</span><span class="st">"proteins"</span>,<span class="st">"pro"</span>,varname),</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">ifelse</span>(varname<span class="sc">==</span><span class="st">"proteins_kg"</span>,<span class="st">"pro_kg"</span>,varname)</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>   <span class="do">## add labels </span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    distrib_y<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(distrib_y<span class="sc">$</span>varname,</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> varname_list,</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> varlabel_list</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    distrib_y<span class="sc">$</span>drig_f <span class="ot">&lt;-</span> </span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(distrib_y<span class="sc">$</span>drig,</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> drig_list,</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> drig_label</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># clean</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"distrib_pro"</span>,<span class="st">"distrib_cavitd"</span>,<span class="st">"distrib_miscA"</span>,<span class="st">"distrib_miscB"</span>))</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a><span class="co"># ************************************************************************ #</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a><span class="co">#                 Import SAS data on marginal Pr(X&lt;EAR)                    #</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a><span class="co"># ************************************************************************ #</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: mrg, marginal (crude population average)</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Protein                     #</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>mrg_pro <span class="ot">&lt;-</span> </span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_rel_wf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Hardcoded value for Pr(X&lt;EAR)</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"Prob1"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient identifier</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"pro"</span>)</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a><span class="co">#             Calcium and Vitamin D              #</span></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>mrg_cavitd <span class="ot">&lt;-</span> </span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_wf.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="fu">grep</span>(<span class="st">"EAR"</span>,name)) </span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a><span class="co">#         Iron, Zinc, Vit. B6, Vit. B12          #</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>mrg_miscA <span class="ot">&lt;-</span> </span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_wf.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="fu">grep</span>(<span class="st">"EAR"</span>,name)) </span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a><span class="co">#        Dietary Folate Eq, Mg, K, Fibers        #</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>mrg_miscB <span class="ot">&lt;-</span> </span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_wf.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="fu">grep</span>(<span class="st">"EAR"</span>,name)) </span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a><span class="co">#                Vitamin A (RAE)                 #</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>mrg_rae <span class="ot">&lt;-</span> </span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_wf.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="fu">grep</span>(<span class="st">"EAR"</span>,name)) </span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a><span class="co">#            Append nutrient distrib             #</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>mrg_all <span class="ot">&lt;-</span> </span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(mrg_pro,mrg_cavitd,</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>        mrg_miscA,mrg_miscB,</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>        mrg_rae) <span class="sc">|&gt;</span></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: fibers and potassium (Pr(X&lt;Adequate Intake)) cannot appear here, since cut-point is not EAR</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span>(varname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fibers"</span>,<span class="st">"pota"</span>))</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a><span class="do">## add labels </span></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>mrg_all<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(mrg_all<span class="sc">$</span>varname,</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels =</span> varname_list,</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> varlabel_list )</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a><span class="do">## remove units</span></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>mrg_all <span class="ot">&lt;-</span></span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>  mrg_all <span class="sc">|&gt;</span></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>   <span class="co"># remove units from &lt;varname_f&gt;</span></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> varname_f,</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>      <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"varname_f"</span>,<span class="st">"unit"</span>),</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">', '</span></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a><span class="co"># clean temporary </span></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a> <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"mrg_pro"</span>,<span class="st">"mrg_cavitd"</span>,<span class="st">"mrg_miscA"</span>,<span class="st">"mrg_miscB"</span>,<span class="st">"mrg_rae"</span>))</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a> mrg_all_drig0_ordered <span class="ot">&lt;-</span> </span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>   mrg_all <span class="sc">|&gt;</span></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(estimate)) </span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a> <span class="co"># save data for further analyses</span></span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a> <span class="fu">save</span>(mrg_all, <span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"mrg_all.rdata"</span>))</span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a><span class="co">#               Output reg. coef. estimate for t1t0 diff.                 #</span></span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: difference can either be presented in table, used to sort graph or both</span></span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Protein                     #</span></span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>linreg_beta_pro <span class="ot">&lt;-</span> </span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_drigf.sas7bdat'</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"pro"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">!=</span><span class="st">"r2"</span>)</span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a><span class="co">#             Calcium and Vitamin D              #</span></span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>linreg_beta_catvitd <span class="ot">&lt;-</span> </span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group </span></span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_drigf.sas7bdat'</span>))</span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">!=</span><span class="st">"r2"</span>)</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a><span class="co">#         Iron, Zinc, Vit. B6, Vit. B12          #</span></span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>linreg_beta_miscA <span class="ot">&lt;-</span> </span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_drigf.sas7bdat'</span>))</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">!=</span><span class="st">"r2"</span>)</span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a><span class="co">#        Dietary Folate Eq, Mg, K, Fibers        #</span></span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>linreg_beta_miscB <span class="ot">&lt;-</span> </span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_drigf.sas7bdat'</span>))</span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">!=</span><span class="st">"r2"</span>)</span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a><span class="co">#                Vitamin A (RAE)                 #</span></span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a>linreg_beta_rae <span class="ot">&lt;-</span> </span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_drigf.sas7bdat'</span>))</span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">!=</span><span class="st">"r2"</span>)</span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a><span class="co"># Append all nutrient, remove useless variables  #</span></span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a>linreg_beta_all <span class="ot">&lt;-</span> </span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(linreg_beta_pro,linreg_beta_catvitd,</span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a>        linreg_beta_miscA,linreg_beta_miscB,</span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a>        linreg_beta_rae) <span class="sc">|&gt;</span> </span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(name,alpha,one_minus_half_alpha,</span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a>            t_quant,tvalue,pvalue,svalue,<span class="st">`</span><span class="at">_ci</span><span class="st">`</span>,<span class="st">`</span><span class="at">_se</span><span class="st">`</span>,</span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a>            estimate_se)) </span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a>   <span class="do">## add labels </span></span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>    linreg_beta_all<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(linreg_beta_all<span class="sc">$</span>varname,</span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> varname_list,</span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> varlabel_list</span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a>    linreg_beta_all<span class="sc">$</span>drig_f <span class="ot">&lt;-</span> </span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(linreg_beta_all<span class="sc">$</span>drig,</span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> drig_list,</span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> drig_label</span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"linreg_beta_pro"</span>,</span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_beta_catvitd"</span>,</span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_beta_miscA"</span>,</span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_beta_miscB"</span>,</span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_beta_rae"</span>))</span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a><span class="co"># Make new estimate with proper rounding</span></span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a>linreg_beta_all <span class="ot">&lt;-</span> </span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a>  linreg_beta_all <span class="sc">|&gt;</span> </span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>estimate_ci) <span class="sc">|&gt;</span> </span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a>    <span class="at">rounding =</span> </span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a>      <span class="fu">case_when</span> (</span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a>       varname <span class="sc">==</span> <span class="st">'pro'</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'pro_kg'</span> <span class="sc">~</span> <span class="fl">0.01</span>,</span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'calcium'</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'vit_d'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'iron'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'zinc'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'vit_b6'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'vit_b12'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'dfe'</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'mg'</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-312"><a href="#cb2-312" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'pota'</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-313"><a href="#cb2-313" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'fibers'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb2-314"><a href="#cb2-314" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'rae'</span> <span class="sc">~</span> <span class="dv">1</span> ),</span>
<span id="cb2-315"><a href="#cb2-315" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_ci =</span> <span class="fu">makeEstimateCI</span>(estimate,lcl95,ucl95,<span class="at">sep=</span><span class="st">", "</span>,<span class="at">rounding=</span>rounding)</span>
<span id="cb2-316"><a href="#cb2-316" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-317"><a href="#cb2-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-318"><a href="#cb2-318" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-319"><a href="#cb2-319" aria-hidden="true" tabindex="-1"></a><span class="co">#      Rescale coef. as a function of mean       #</span></span>
<span id="cb2-320"><a href="#cb2-320" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-321"><a href="#cb2-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-322"><a href="#cb2-322" aria-hidden="true" tabindex="-1"></a><span class="co"># Import distribution data to obtain mean (usual) intake</span></span>
<span id="cb2-323"><a href="#cb2-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-324"><a href="#cb2-324" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: &lt;distrib_y&gt; data created in chunk &lt;distrib-y-data&gt;</span></span>
<span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a>linreg_beta_all_ratio <span class="ot">&lt;-</span> </span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a>  distrib_y <span class="sc">|&gt;</span> </span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select relevant variables</span></span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(varname,drig,Mean) <span class="sc">|&gt;</span> </span>
<span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine with lin. reg. beta, keeping only rows in that data</span></span>
<span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">right_join</span>(linreg_beta_all) <span class="sc">|&gt;</span> </span>
<span id="cb2-332"><a href="#cb2-332" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate diff. as a proportion of mean</span></span>
<span id="cb2-333"><a href="#cb2-333" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-334"><a href="#cb2-334" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio =</span> estimate<span class="sc">/</span>Mean</span>
<span id="cb2-335"><a href="#cb2-335" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-336"><a href="#cb2-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-337"><a href="#cb2-337" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector of variable names according to ratio value</span></span>
<span id="cb2-338"><a href="#cb2-338" aria-hidden="true" tabindex="-1"></a>y_sorted_beta_drig0 <span class="ot">&lt;-</span></span>
<span id="cb2-339"><a href="#cb2-339" aria-hidden="true" tabindex="-1"></a>  linreg_beta_all_ratio <span class="sc">|&gt;</span></span>
<span id="cb2-340"><a href="#cb2-340" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-341"><a href="#cb2-341" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(ratio)) <span class="sc">|&gt;</span></span>
<span id="cb2-342"><a href="#cb2-342" aria-hidden="true" tabindex="-1"></a>   <span class="co"># remove units from varnames_f</span></span>
<span id="cb2-343"><a href="#cb2-343" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(</span>
<span id="cb2-344"><a href="#cb2-344" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> varname_f,</span>
<span id="cb2-345"><a href="#cb2-345" aria-hidden="true" tabindex="-1"></a>      <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"varname_f2"</span>,<span class="st">"unit"</span>),</span>
<span id="cb2-346"><a href="#cb2-346" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">', '</span>,</span>
<span id="cb2-347"><a href="#cb2-347" aria-hidden="true" tabindex="-1"></a>      <span class="at">remove=</span><span class="cn">FALSE</span></span>
<span id="cb2-348"><a href="#cb2-348" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb2-349"><a href="#cb2-349" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-350"><a href="#cb2-350" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname_f2 =</span> <span class="fu">lapply</span>(varname_f2,<span class="cf">function</span>(x) <span class="fu">str_replace</span>(x, <span class="st">"^</span><span class="sc">\\</span><span class="st">w{1}"</span>, tolower) )</span>
<span id="cb2-351"><a href="#cb2-351" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-352"><a href="#cb2-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-353"><a href="#cb2-353" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-354"><a href="#cb2-354" aria-hidden="true" tabindex="-1"></a><span class="co">#             Save intermediate data             #</span></span>
<span id="cb2-355"><a href="#cb2-355" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-356"><a href="#cb2-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-357"><a href="#cb2-357" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(linreg_beta_all,</span>
<span id="cb2-358"><a href="#cb2-358" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"linreg_beta_all.rdata"</span>))</span>
<span id="cb2-359"><a href="#cb2-359" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(y_sorted_beta_drig0,</span>
<span id="cb2-360"><a href="#cb2-360" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"y_sorted_beta_drig0.rdata"</span>))</span>
<span id="cb2-361"><a href="#cb2-361" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-362"><a href="#cb2-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-363"><a href="#cb2-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-364"><a href="#cb2-364" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb2-365"><a href="#cb2-365" aria-hidden="true" tabindex="-1"></a><span class="co">#        Output Pr(X&lt;EAR | HEFI=t1),Pr(X&lt;EAR | HEFI=t0) and diff.         #</span></span>
<span id="cb2-366"><a href="#cb2-366" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb2-367"><a href="#cb2-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-368"><a href="#cb2-368" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-369"><a href="#cb2-369" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Protein                     #</span></span>
<span id="cb2-370"><a href="#cb2-370" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-371"><a href="#cb2-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-372"><a href="#cb2-372" aria-hidden="true" tabindex="-1"></a>logreg_beta_pro0 <span class="ot">&lt;-</span> </span>
<span id="cb2-373"><a href="#cb2-373" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_hefi_y06_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-374"><a href="#cb2-374" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb2-375"><a href="#cb2-375" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>,</span>
<span id="cb2-376"><a href="#cb2-376" aria-hidden="true" tabindex="-1"></a>                <span class="at">t1perc=</span><span class="dv">90</span>,</span>
<span id="cb2-377"><a href="#cb2-377" aria-hidden="true" tabindex="-1"></a>                <span class="at">t0perc=</span><span class="dv">50</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-378"><a href="#cb2-378" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb2-379"><a href="#cb2-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_hefi_y06_raw0.sas7bdat'</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb2-380"><a href="#cb2-380" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"pro"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-381"><a href="#cb2-381" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span></span>
<span id="cb2-382"><a href="#cb2-382" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-383"><a href="#cb2-383" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"pro_kg"</span></span>
<span id="cb2-384"><a href="#cb2-384" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-385"><a href="#cb2-385" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(t1perc,t0perc))</span>
<span id="cb2-386"><a href="#cb2-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-387"><a href="#cb2-387" aria-hidden="true" tabindex="-1"></a>logreg_beta_pro <span class="ot">&lt;-</span> </span>
<span id="cb2-388"><a href="#cb2-388" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-389"><a href="#cb2-389" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb2-390"><a href="#cb2-390" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-391"><a href="#cb2-391" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb2-392"><a href="#cb2-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_drigf.sas7bdat'</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb2-393"><a href="#cb2-393" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"pro"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-394"><a href="#cb2-394" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb2-395"><a href="#cb2-395" aria-hidden="true" tabindex="-1"></a>  <span class="co"># keeping only Pr(X&lt;EAR)</span></span>
<span id="cb2-396"><a href="#cb2-396" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(outcome<span class="sc">==</span><span class="st">"binary_06"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-397"><a href="#cb2-397" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-398"><a href="#cb2-398" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"pro_kg"</span></span>
<span id="cb2-399"><a href="#cb2-399" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-400"><a href="#cb2-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-401"><a href="#cb2-401" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-402"><a href="#cb2-402" aria-hidden="true" tabindex="-1"></a><span class="co">#             Calcium and Vitamin D              #</span></span>
<span id="cb2-403"><a href="#cb2-403" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-404"><a href="#cb2-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-405"><a href="#cb2-405" aria-hidden="true" tabindex="-1"></a><span class="co"># Import base model with Pr(X&lt;EAR) at t1 and t0</span></span>
<span id="cb2-406"><a href="#cb2-406" aria-hidden="true" tabindex="-1"></a>cavitd0 <span class="ot">&lt;-</span> </span>
<span id="cb2-407"><a href="#cb2-407" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_ca_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-408"><a href="#cb2-408" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-409"><a href="#cb2-409" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"calcium"</span></span>
<span id="cb2-410"><a href="#cb2-410" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-411"><a href="#cb2-411" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_vitd_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-412"><a href="#cb2-412" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-413"><a href="#cb2-413" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_d"</span></span>
<span id="cb2-414"><a href="#cb2-414" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-415"><a href="#cb2-415" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>)</span>
<span id="cb2-416"><a href="#cb2-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-417"><a href="#cb2-417" aria-hidden="true" tabindex="-1"></a>cavitd_drig0 <span class="ot">&lt;-</span> </span>
<span id="cb2-418"><a href="#cb2-418" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_ca_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-419"><a href="#cb2-419" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-420"><a href="#cb2-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"calcium"</span></span>
<span id="cb2-421"><a href="#cb2-421" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb2-422"><a href="#cb2-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_vitd_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-423"><a href="#cb2-423" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-424"><a href="#cb2-424" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_d"</span></span>
<span id="cb2-425"><a href="#cb2-425" aria-hidden="true" tabindex="-1"></a>      ) ) <span class="sc">|&gt;</span> </span>
<span id="cb2-426"><a href="#cb2-426" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(t0perc,t1perc))</span>
<span id="cb2-427"><a href="#cb2-427" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-428"><a href="#cb2-428" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Append both</span></span>
<span id="cb2-429"><a href="#cb2-429" aria-hidden="true" tabindex="-1"></a>  logreg_beta_catvitd0 <span class="ot">&lt;-</span> </span>
<span id="cb2-430"><a href="#cb2-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(cavitd0,cavitd_drig0)  </span>
<span id="cb2-431"><a href="#cb2-431" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-432"><a href="#cb2-432" aria-hidden="true" tabindex="-1"></a>  <span class="do">## clean </span></span>
<span id="cb2-433"><a href="#cb2-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"cavitd0"</span>,<span class="st">"cavitd_drig0"</span>))</span>
<span id="cb2-434"><a href="#cb2-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-435"><a href="#cb2-435" aria-hidden="true" tabindex="-1"></a><span class="co"># Import risk ratio</span></span>
<span id="cb2-436"><a href="#cb2-436" aria-hidden="true" tabindex="-1"></a>logreg_beta_catvitd <span class="ot">&lt;-</span> </span>
<span id="cb2-437"><a href="#cb2-437" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-438"><a href="#cb2-438" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb2-439"><a href="#cb2-439" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb2-440"><a href="#cb2-440" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-441"><a href="#cb2-441" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group </span></span>
<span id="cb2-442"><a href="#cb2-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb2-443"><a href="#cb2-443" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_drigf.sas7bdat'</span>))</span>
<span id="cb2-444"><a href="#cb2-444" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-445"><a href="#cb2-445" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb2-446"><a href="#cb2-446" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some formatting for consistency</span></span>
<span id="cb2-447"><a href="#cb2-447" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">outcome=</span>varname) <span class="sc">|&gt;</span> </span>
<span id="cb2-448"><a href="#cb2-448" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-449"><a href="#cb2-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-450"><a href="#cb2-450" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_ca"</span> <span class="sc">~</span> <span class="st">"calcium"</span>,</span>
<span id="cb2-451"><a href="#cb2-451" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_vitd"</span> <span class="sc">~</span> <span class="st">"vit_d"</span></span>
<span id="cb2-452"><a href="#cb2-452" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-453"><a href="#cb2-453" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-454"><a href="#cb2-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-455"><a href="#cb2-455" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-456"><a href="#cb2-456" aria-hidden="true" tabindex="-1"></a><span class="co">#         Iron, Zinc, Vit. B6, Vit. B12          #</span></span>
<span id="cb2-457"><a href="#cb2-457" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-458"><a href="#cb2-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-459"><a href="#cb2-459" aria-hidden="true" tabindex="-1"></a><span class="co"># Import base model with Pr(X&lt;EAR) at t1 and t0</span></span>
<span id="cb2-460"><a href="#cb2-460" aria-hidden="true" tabindex="-1"></a>miscA0 <span class="ot">&lt;-</span> </span>
<span id="cb2-461"><a href="#cb2-461" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_iron_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-462"><a href="#cb2-462" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-463"><a href="#cb2-463" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"iron"</span></span>
<span id="cb2-464"><a href="#cb2-464" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-465"><a href="#cb2-465" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_zinc_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-466"><a href="#cb2-466" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-467"><a href="#cb2-467" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"zinc"</span></span>
<span id="cb2-468"><a href="#cb2-468" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-469"><a href="#cb2-469" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_b6_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-470"><a href="#cb2-470" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-471"><a href="#cb2-471" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_b6"</span></span>
<span id="cb2-472"><a href="#cb2-472" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-473"><a href="#cb2-473" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_b12_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-474"><a href="#cb2-474" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-475"><a href="#cb2-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_b12"</span></span>
<span id="cb2-476"><a href="#cb2-476" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-477"><a href="#cb2-477" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>)</span>
<span id="cb2-478"><a href="#cb2-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-479"><a href="#cb2-479" aria-hidden="true" tabindex="-1"></a>miscA_drig0 <span class="ot">&lt;-</span> </span>
<span id="cb2-480"><a href="#cb2-480" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_iron_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-481"><a href="#cb2-481" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-482"><a href="#cb2-482" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"iron"</span></span>
<span id="cb2-483"><a href="#cb2-483" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-484"><a href="#cb2-484" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_zinc_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-485"><a href="#cb2-485" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-486"><a href="#cb2-486" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"zinc"</span></span>
<span id="cb2-487"><a href="#cb2-487" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-488"><a href="#cb2-488" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_b6_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-489"><a href="#cb2-489" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-490"><a href="#cb2-490" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_b6"</span></span>
<span id="cb2-491"><a href="#cb2-491" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-492"><a href="#cb2-492" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_b12_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-493"><a href="#cb2-493" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-494"><a href="#cb2-494" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_b12"</span></span>
<span id="cb2-495"><a href="#cb2-495" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-496"><a href="#cb2-496" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(t0perc,t1perc))</span>
<span id="cb2-497"><a href="#cb2-497" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-498"><a href="#cb2-498" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Append both</span></span>
<span id="cb2-499"><a href="#cb2-499" aria-hidden="true" tabindex="-1"></a>  logreg_beta_miscA0 <span class="ot">&lt;-</span> </span>
<span id="cb2-500"><a href="#cb2-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(miscA0,miscA_drig0)  </span>
<span id="cb2-501"><a href="#cb2-501" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-502"><a href="#cb2-502" aria-hidden="true" tabindex="-1"></a>  <span class="do">## clean </span></span>
<span id="cb2-503"><a href="#cb2-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"miscA0"</span>,<span class="st">"miscA_drig0"</span>))</span>
<span id="cb2-504"><a href="#cb2-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-505"><a href="#cb2-505" aria-hidden="true" tabindex="-1"></a><span class="co"># Import risk ratio</span></span>
<span id="cb2-506"><a href="#cb2-506" aria-hidden="true" tabindex="-1"></a>logreg_beta_miscA <span class="ot">&lt;-</span> </span>
<span id="cb2-507"><a href="#cb2-507" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-508"><a href="#cb2-508" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb2-509"><a href="#cb2-509" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb2-510"><a href="#cb2-510" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-511"><a href="#cb2-511" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb2-512"><a href="#cb2-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb2-513"><a href="#cb2-513" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_drigf.sas7bdat'</span>))</span>
<span id="cb2-514"><a href="#cb2-514" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-515"><a href="#cb2-515" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb2-516"><a href="#cb2-516" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some formatting for consistency</span></span>
<span id="cb2-517"><a href="#cb2-517" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">outcome=</span>varname) <span class="sc">|&gt;</span> </span>
<span id="cb2-518"><a href="#cb2-518" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-519"><a href="#cb2-519" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-520"><a href="#cb2-520" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_iron"</span> <span class="sc">~</span> <span class="st">"iron"</span>,</span>
<span id="cb2-521"><a href="#cb2-521" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_zinc"</span> <span class="sc">~</span> <span class="st">"zinc"</span>,</span>
<span id="cb2-522"><a href="#cb2-522" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_b6"</span> <span class="sc">~</span> <span class="st">"vit_b6"</span>,</span>
<span id="cb2-523"><a href="#cb2-523" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_b12"</span> <span class="sc">~</span> <span class="st">"vit_b12"</span></span>
<span id="cb2-524"><a href="#cb2-524" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-525"><a href="#cb2-525" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-526"><a href="#cb2-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-527"><a href="#cb2-527" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-528"><a href="#cb2-528" aria-hidden="true" tabindex="-1"></a><span class="co">#        Dietary Folate Eq, Mg, K, Fibers        #</span></span>
<span id="cb2-529"><a href="#cb2-529" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-530"><a href="#cb2-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-531"><a href="#cb2-531" aria-hidden="true" tabindex="-1"></a><span class="co"># Import base model with Pr(X&lt;EAR) at t1 and t0</span></span>
<span id="cb2-532"><a href="#cb2-532" aria-hidden="true" tabindex="-1"></a>miscB0 <span class="ot">&lt;-</span> </span>
<span id="cb2-533"><a href="#cb2-533" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_dfe_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-534"><a href="#cb2-534" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-535"><a href="#cb2-535" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"dfe"</span></span>
<span id="cb2-536"><a href="#cb2-536" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-537"><a href="#cb2-537" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_mg_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-538"><a href="#cb2-538" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-539"><a href="#cb2-539" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"mg"</span></span>
<span id="cb2-540"><a href="#cb2-540" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-541"><a href="#cb2-541" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_pota_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-542"><a href="#cb2-542" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-543"><a href="#cb2-543" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"pota"</span></span>
<span id="cb2-544"><a href="#cb2-544" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-545"><a href="#cb2-545" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_fib_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-546"><a href="#cb2-546" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-547"><a href="#cb2-547" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"fibers"</span></span>
<span id="cb2-548"><a href="#cb2-548" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-549"><a href="#cb2-549" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>)</span>
<span id="cb2-550"><a href="#cb2-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-551"><a href="#cb2-551" aria-hidden="true" tabindex="-1"></a>miscB_drig0 <span class="ot">&lt;-</span> </span>
<span id="cb2-552"><a href="#cb2-552" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_dfe_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-553"><a href="#cb2-553" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-554"><a href="#cb2-554" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"dfe"</span></span>
<span id="cb2-555"><a href="#cb2-555" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-556"><a href="#cb2-556" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_mg_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-557"><a href="#cb2-557" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-558"><a href="#cb2-558" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"mg"</span></span>
<span id="cb2-559"><a href="#cb2-559" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-560"><a href="#cb2-560" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_pota_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-561"><a href="#cb2-561" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-562"><a href="#cb2-562" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"pota"</span></span>
<span id="cb2-563"><a href="#cb2-563" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-564"><a href="#cb2-564" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_fib_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-565"><a href="#cb2-565" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-566"><a href="#cb2-566" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"fibers"</span></span>
<span id="cb2-567"><a href="#cb2-567" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb2-568"><a href="#cb2-568" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(t0perc,t1perc))</span>
<span id="cb2-569"><a href="#cb2-569" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-570"><a href="#cb2-570" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Append both</span></span>
<span id="cb2-571"><a href="#cb2-571" aria-hidden="true" tabindex="-1"></a>  logreg_beta_miscB0 <span class="ot">&lt;-</span> </span>
<span id="cb2-572"><a href="#cb2-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(miscB0,miscB_drig0)  </span>
<span id="cb2-573"><a href="#cb2-573" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-574"><a href="#cb2-574" aria-hidden="true" tabindex="-1"></a>  <span class="do">## clean </span></span>
<span id="cb2-575"><a href="#cb2-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"miscB0"</span>,<span class="st">"miscB_drig0"</span>))</span>
<span id="cb2-576"><a href="#cb2-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-577"><a href="#cb2-577" aria-hidden="true" tabindex="-1"></a><span class="co"># Import risk ratio</span></span>
<span id="cb2-578"><a href="#cb2-578" aria-hidden="true" tabindex="-1"></a>logreg_beta_miscB <span class="ot">&lt;-</span> </span>
<span id="cb2-579"><a href="#cb2-579" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-580"><a href="#cb2-580" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb2-581"><a href="#cb2-581" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb2-582"><a href="#cb2-582" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-583"><a href="#cb2-583" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb2-584"><a href="#cb2-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb2-585"><a href="#cb2-585" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_drigf.sas7bdat'</span>))</span>
<span id="cb2-586"><a href="#cb2-586" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-587"><a href="#cb2-587" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig)  <span class="sc">|&gt;</span> </span>
<span id="cb2-588"><a href="#cb2-588" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some formatting for consistency</span></span>
<span id="cb2-589"><a href="#cb2-589" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">outcome=</span>varname) <span class="sc">|&gt;</span> </span>
<span id="cb2-590"><a href="#cb2-590" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-591"><a href="#cb2-591" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-592"><a href="#cb2-592" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_dfe"</span> <span class="sc">~</span> <span class="st">"dfe"</span>,</span>
<span id="cb2-593"><a href="#cb2-593" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_fib"</span> <span class="sc">~</span> <span class="st">"fibers"</span>,</span>
<span id="cb2-594"><a href="#cb2-594" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_pota"</span> <span class="sc">~</span> <span class="st">"pota"</span>,</span>
<span id="cb2-595"><a href="#cb2-595" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_mg"</span> <span class="sc">~</span> <span class="st">"mg"</span></span>
<span id="cb2-596"><a href="#cb2-596" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-597"><a href="#cb2-597" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-598"><a href="#cb2-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-599"><a href="#cb2-599" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-600"><a href="#cb2-600" aria-hidden="true" tabindex="-1"></a><span class="co">#                Vitamin A (RAE)                 #</span></span>
<span id="cb2-601"><a href="#cb2-601" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-602"><a href="#cb2-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-603"><a href="#cb2-603" aria-hidden="true" tabindex="-1"></a><span class="co"># Import base model with Pr(X&lt;EAR) at t1 and t0</span></span>
<span id="cb2-604"><a href="#cb2-604" aria-hidden="true" tabindex="-1"></a>logreg_beta_rae0 <span class="ot">&lt;-</span> </span>
<span id="cb2-605"><a href="#cb2-605" aria-hidden="true" tabindex="-1"></a>  (haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_rae_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-606"><a href="#cb2-606" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>) </span>
<span id="cb2-607"><a href="#cb2-607" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">|&gt;</span> </span>
<span id="cb2-608"><a href="#cb2-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb2-609"><a href="#cb2-609" aria-hidden="true" tabindex="-1"></a>    haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_rae_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-610"><a href="#cb2-610" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(t1perc,t0perc)) </span>
<span id="cb2-611"><a href="#cb2-611" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-612"><a href="#cb2-612" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"rae"</span>)</span>
<span id="cb2-613"><a href="#cb2-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-614"><a href="#cb2-614" aria-hidden="true" tabindex="-1"></a><span class="co"># Import risk ratio</span></span>
<span id="cb2-615"><a href="#cb2-615" aria-hidden="true" tabindex="-1"></a>logreg_beta_rae <span class="ot">&lt;-</span> </span>
<span id="cb2-616"><a href="#cb2-616" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-617"><a href="#cb2-617" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb2-618"><a href="#cb2-618" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb2-619"><a href="#cb2-619" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-620"><a href="#cb2-620" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb2-621"><a href="#cb2-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb2-622"><a href="#cb2-622" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_drigf.sas7bdat'</span>))</span>
<span id="cb2-623"><a href="#cb2-623" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-624"><a href="#cb2-624" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig)  <span class="sc">|&gt;</span> </span>
<span id="cb2-625"><a href="#cb2-625" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some formatting for consistency</span></span>
<span id="cb2-626"><a href="#cb2-626" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">outcome=</span>varname) <span class="sc">|&gt;</span> </span>
<span id="cb2-627"><a href="#cb2-627" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-628"><a href="#cb2-628" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-629"><a href="#cb2-629" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_rae"</span> <span class="sc">~</span> <span class="st">"rae"</span></span>
<span id="cb2-630"><a href="#cb2-630" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-631"><a href="#cb2-631" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-632"><a href="#cb2-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-633"><a href="#cb2-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-634"><a href="#cb2-634" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-635"><a href="#cb2-635" aria-hidden="true" tabindex="-1"></a><span class="co"># Append all nutrient, remove useless variables  #</span></span>
<span id="cb2-636"><a href="#cb2-636" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-637"><a href="#cb2-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-638"><a href="#cb2-638" aria-hidden="true" tabindex="-1"></a><span class="co"># Pr(X&lt;EAR) at t1 and t0</span></span>
<span id="cb2-639"><a href="#cb2-639" aria-hidden="true" tabindex="-1"></a>logreg_beta_all0 <span class="ot">&lt;-</span> </span>
<span id="cb2-640"><a href="#cb2-640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(logreg_beta_pro0,logreg_beta_catvitd0,</span>
<span id="cb2-641"><a href="#cb2-641" aria-hidden="true" tabindex="-1"></a>        logreg_beta_miscA0,logreg_beta_miscB0,</span>
<span id="cb2-642"><a href="#cb2-642" aria-hidden="true" tabindex="-1"></a>        logreg_beta_rae0) <span class="sc">|&gt;</span> </span>
<span id="cb2-643"><a href="#cb2-643" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(replicate,z,log_beta0)) <span class="sc">|&gt;</span> </span>
<span id="cb2-644"><a href="#cb2-644" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate t1 vs t0 difference to assess consistency</span></span>
<span id="cb2-645"><a href="#cb2-645" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-646"><a href="#cb2-646" aria-hidden="true" tabindex="-1"></a>    <span class="at">t1t0_diff =</span> t1<span class="sc">-</span>t0</span>
<span id="cb2-647"><a href="#cb2-647" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-648"><a href="#cb2-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-649"><a href="#cb2-649" aria-hidden="true" tabindex="-1"></a>   <span class="do">## add labels </span></span>
<span id="cb2-650"><a href="#cb2-650" aria-hidden="true" tabindex="-1"></a>    logreg_beta_all0<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb2-651"><a href="#cb2-651" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(logreg_beta_all0<span class="sc">$</span>varname,</span>
<span id="cb2-652"><a href="#cb2-652" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> varname_list,</span>
<span id="cb2-653"><a href="#cb2-653" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> varlabeltidy_list</span>
<span id="cb2-654"><a href="#cb2-654" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb2-655"><a href="#cb2-655" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-656"><a href="#cb2-656" aria-hidden="true" tabindex="-1"></a>    logreg_beta_all0<span class="sc">$</span>drig_f <span class="ot">&lt;-</span> </span>
<span id="cb2-657"><a href="#cb2-657" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(logreg_beta_all0<span class="sc">$</span>drig,</span>
<span id="cb2-658"><a href="#cb2-658" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> drig_list,</span>
<span id="cb2-659"><a href="#cb2-659" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> drig_label</span>
<span id="cb2-660"><a href="#cb2-660" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb2-661"><a href="#cb2-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-662"><a href="#cb2-662" aria-hidden="true" tabindex="-1"></a><span class="co"># Risk ratio estimate</span></span>
<span id="cb2-663"><a href="#cb2-663" aria-hidden="true" tabindex="-1"></a>logreg_beta_all <span class="ot">&lt;-</span> </span>
<span id="cb2-664"><a href="#cb2-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(logreg_beta_pro,logreg_beta_catvitd,</span>
<span id="cb2-665"><a href="#cb2-665" aria-hidden="true" tabindex="-1"></a>        logreg_beta_miscA,logreg_beta_miscB,</span>
<span id="cb2-666"><a href="#cb2-666" aria-hidden="true" tabindex="-1"></a>        logreg_beta_rae) <span class="sc">|&gt;</span> </span>
<span id="cb2-667"><a href="#cb2-667" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(label,alpha,one_minus_half_alpha,</span>
<span id="cb2-668"><a href="#cb2-668" aria-hidden="true" tabindex="-1"></a>            t_quant,tvalue,pvalue,svalue,<span class="st">`</span><span class="at">_ci</span><span class="st">`</span>,<span class="st">`</span><span class="at">_se</span><span class="st">`</span>,</span>
<span id="cb2-669"><a href="#cb2-669" aria-hidden="true" tabindex="-1"></a>            estimate_se,estimate_ci)) <span class="sc">|&gt;</span></span>
<span id="cb2-670"><a href="#cb2-670" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove fibers and potassium (AI) which cannot be shown in this figure</span></span>
<span id="cb2-671"><a href="#cb2-671" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb2-672"><a href="#cb2-672" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>(varname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fibers"</span>,<span class="st">"pota"</span>))</span>
<span id="cb2-673"><a href="#cb2-673" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-674"><a href="#cb2-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-675"><a href="#cb2-675" aria-hidden="true" tabindex="-1"></a>   <span class="do">## add labels </span></span>
<span id="cb2-676"><a href="#cb2-676" aria-hidden="true" tabindex="-1"></a>    logreg_beta_all<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb2-677"><a href="#cb2-677" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(logreg_beta_all<span class="sc">$</span>varname,</span>
<span id="cb2-678"><a href="#cb2-678" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> varname_list,</span>
<span id="cb2-679"><a href="#cb2-679" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> varlabeltidy_list</span>
<span id="cb2-680"><a href="#cb2-680" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb2-681"><a href="#cb2-681" aria-hidden="true" tabindex="-1"></a>    logreg_beta_all<span class="sc">$</span>drig_f <span class="ot">&lt;-</span> </span>
<span id="cb2-682"><a href="#cb2-682" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(logreg_beta_all<span class="sc">$</span>drig,</span>
<span id="cb2-683"><a href="#cb2-683" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> drig_list,</span>
<span id="cb2-684"><a href="#cb2-684" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> drig_label</span>
<span id="cb2-685"><a href="#cb2-685" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb2-686"><a href="#cb2-686" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-687"><a href="#cb2-687" aria-hidden="true" tabindex="-1"></a><span class="do">## clean temporary</span></span>
<span id="cb2-688"><a href="#cb2-688" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"logreg_beta_pro"</span>,</span>
<span id="cb2-689"><a href="#cb2-689" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_catvitd"</span>,</span>
<span id="cb2-690"><a href="#cb2-690" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_miscA"</span>,</span>
<span id="cb2-691"><a href="#cb2-691" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_miscB"</span>,</span>
<span id="cb2-692"><a href="#cb2-692" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_rae"</span>,</span>
<span id="cb2-693"><a href="#cb2-693" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_pro0"</span>,</span>
<span id="cb2-694"><a href="#cb2-694" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_catvitd0"</span>,</span>
<span id="cb2-695"><a href="#cb2-695" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_miscA0"</span>,</span>
<span id="cb2-696"><a href="#cb2-696" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_miscB0"</span>,</span>
<span id="cb2-697"><a href="#cb2-697" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_rae0"</span>))</span>
<span id="cb2-698"><a href="#cb2-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-699"><a href="#cb2-699" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare ordered, formatted data for in text citation purpose</span></span>
<span id="cb2-700"><a href="#cb2-700" aria-hidden="true" tabindex="-1"></a>logreg_beta_drig0_ordered <span class="ot">&lt;-</span> </span>
<span id="cb2-701"><a href="#cb2-701" aria-hidden="true" tabindex="-1"></a>  logreg_beta_all <span class="sc">|&gt;</span></span>
<span id="cb2-702"><a href="#cb2-702" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span>,name<span class="sc">==</span><span class="st">"risk_diff"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-703"><a href="#cb2-703" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(estimate) <span class="sc">|&gt;</span></span>
<span id="cb2-704"><a href="#cb2-704" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb2-705"><a href="#cb2-705" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname_f2 =</span> <span class="fu">lapply</span>(varname_f,<span class="cf">function</span>(x) <span class="fu">str_replace</span>(x, <span class="st">"^</span><span class="sc">\\</span><span class="st">w{1}"</span>, tolower) )</span>
<span id="cb2-706"><a href="#cb2-706" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-707"><a href="#cb2-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-708"><a href="#cb2-708" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-709"><a href="#cb2-709" aria-hidden="true" tabindex="-1"></a><span class="co">#  Save data to re-use in Supplemental Material  #</span></span>
<span id="cb2-710"><a href="#cb2-710" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-711"><a href="#cb2-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-712"><a href="#cb2-712" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(logreg_beta_all0,</span>
<span id="cb2-713"><a href="#cb2-713" aria-hidden="true" tabindex="-1"></a>     <span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"logreg_beta_all0.rdata"</span>))</span>
<span id="cb2-714"><a href="#cb2-714" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(logreg_beta_all,</span>
<span id="cb2-715"><a href="#cb2-715" aria-hidden="true" tabindex="-1"></a>     <span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"logreg_beta_all.rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                      Design and descriptive data                        #</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#               CCHS 2015 - Sample               #</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># HS data file</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>hs_nci <span class="ot">&lt;-</span> <span class="co"># note: includes data from recall 1 and 2</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'Data'</span>,<span class="st">'Processed'</span>, <span class="st">'hs_nci.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(age<span class="sc">&gt;=</span><span class="dv">65</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>hs_65y <span class="ot">&lt;-</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  hs_nci <span class="sc">|&gt;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(SUPPID<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Output sample size for reporting</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  sample_size <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">nrow</span>(hs_65y))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Output 24-hour recall stat (repeat, zero energy)</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  sample_r24 <span class="ot">&lt;-</span> </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">n        =</span> <span class="fu">nrow</span>(hs_65y),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">repeat_n =</span> <span class="fu">nrow</span>(hs_nci[hs_nci<span class="sc">$</span>SUPPID<span class="sc">==</span><span class="dv">2</span>,]),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">zero_energy_n =</span> <span class="fu">nrow</span>(hs_nci[hs_nci<span class="sc">$</span>SUPPID<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> hs_nci<span class="sc">$</span>energy<span class="sc">==</span><span class="dv">0</span>,])</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">repeat_p =</span> repeat_n <span class="sc">/</span> n,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">repeat_p100 =</span> <span class="fu">round</span>(repeat_p<span class="sc">*</span><span class="dv">100</span>,<span class="dv">0</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Input data and CCHS 2015 design</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Sampling weights only (no variance needed)</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  cchs_65y_design <span class="ot">&lt;-</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    survey<span class="sc">::</span><span class="fu">svydesign</span>(<span class="at">id=</span><span class="sc">~</span><span class="dv">0</span>,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data=</span>hs_65y,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weights =</span> <span class="sc">~</span>WTS_P)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="do">## proportion of males / females</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  sample_sex <span class="ot">&lt;-</span> </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    survey<span class="sc">::</span><span class="fu">svytable</span>(<span class="sc">~</span>sex,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">design=</span>cchs_65y_design) <span class="sc">|&gt;</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">values_from =</span> n, <span class="at">names_from =</span> sex, <span class="at">names_prefix =</span> <span class="st">"sex"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">males_n=</span>sex1,<span class="at">females_n=</span>sex2) <span class="sc">|&gt;</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_n =</span> (males_n<span class="sc">+</span>females_n),</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">males_p =</span> (males_n <span class="sc">/</span> total_n),</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">females_p =</span> (females_n <span class="sc">/</span> total_n)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="do">## mean age</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  sample_age <span class="ot">&lt;-</span> </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    survey<span class="sc">::</span><span class="fu">svymean</span>(<span class="sc">~</span>age,<span class="at">design=</span>cchs_65y_design) <span class="sc">|&gt;</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() </span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co">#          HEFI-2019 score: descriptive          #</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>hefi19_score <span class="ot">&lt;-</span> </span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_score'</span>, <span class="st">'Results'</span>, <span class="st">'distribtotal_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_sd =</span> <span class="fu">makeEstimate</span>(Mean,StdDev,<span class="fl">0.1</span>),</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pre calculate change of interest</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">change =</span> Pctile90 <span class="sc">-</span> Pctile50</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="co">#                Summary data based on &lt;ref.label&gt; chunks                 #</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">#note: &lt;logreg_beta_all&gt; created in chunk &lt;logreg-data&gt;</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>logreg_beta_RD_sorted <span class="ot">&lt;-</span> </span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>  logreg_beta_all <span class="sc">|&gt;</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"risk_diff"</span>,drig<span class="sc">==</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(estimate) <span class="sc">|&gt;</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create 95ci manually for citing</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci95 =</span> <span class="fu">paste0</span>(<span class="st">"("</span>,scales<span class="sc">::</span><span class="fu">number</span>(lcl95,<span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>          <span class="st">", "</span>, scales<span class="sc">::</span><span class="fu">number</span>(ucl95,<span class="at">accuracy =</span> <span class="fl">0.1</span>), <span class="st">")"</span>),</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">est_txt =</span> </span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>( scales<span class="sc">::</span><span class="fu">number</span>(estimate,<span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>        <span class="st">"% [95%CI: "</span>,scales<span class="sc">::</span><span class="fu">number</span>(lcl95,<span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>          <span class="st">", "</span>, scales<span class="sc">::</span><span class="fu">number</span>(ucl95,<span class="at">accuracy =</span> <span class="fl">0.1</span>), <span class="st">"]"</span>)  </span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Background:</strong> Following Canada’s food guide (CFG) recommendations should ensure adequate nutrient intakes. Older adults have increased needs for certain nutrients and nutrient density; the extent to which adherence to CFG recommendations can help reduce inadequate nutrient intakes is unknown.</p>
<p><strong>Objective:</strong> Our aim was to assess the relationship between adherence to CFG recommendations on healthy food choices and intake of key nutrients in adults 65 years and older from the Canadian Community Health Survey (CCHS) 2015 - Nutrition.</p>
<p><strong>Methods:</strong> Secondary analysis of data from 4,093 older adults of the CCHS 2015 - Nutrition (mean age, 73.6 y, 54% females). Dietary intakes were measured using an interviewer-administered 24-hour dietary recall including one repeat in a subsample (42%). The National Cancer Institute multivariate method was used to estimate usual (i.e., long-term) dietary intakes. Adherence to CFG recommendations was measured using the Healthy Eating Food Index (HEFI)-2019 score. Simple linear and logistic regression models estimated the effect of increased HEFI-2019 score on usual nutrient intakes and the prevalence of inadequate nutrient intakes (i.e., below the estimated average requirements), respectively.</p>
<p><strong>Results:</strong> Compared with the prevalence of inadequate intakes at median HEFI-2019 score (46.4/80 points), a higher HEFI-2019 (+11 points) was associated with reductions in the prevalence of inadequate intakes of magnesium, vitamin B6, and protein (-19.8% [95%CI: -30.8, -8.9], -12.7% [95%CI: -22.5, -3.0], and -4.7% [95%CI: -9.4, -0.1], respectively). On the contrary, data for higher HEFI-2019 scores were compatible with increased in the prevalence of inadequate intakes of folate, vitamin d, and calcium (4.0% [95%CI: -8.4, 16.3], 2.6% [95%CI: 1.1, 4.0], and 2.3% [95%CI: -3.0, 7.5], respectively).</p>
<p><strong>Conclusion:</strong> Based on dietary intakes of Canadian older adults in 2015, increasing the degree of adherence to CFG recommendations on healthy food choices may reduce nutrient intake inadequacy for most key nutrients except folate, vitamin D and calcium.</p>
<p><strong>Keywords:</strong> older adults, 24-hour dietary recalls; CFG; HEFI-2019; Canada’s Food Guide; dietary guidelines; healthy eating food index; Canadian Community Health Survey; CCHS.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Previous editions of the Canada’s Food Guide (CFG) informed on food choices to prevent malnutrition as the primary goal. Recommendations of the CFG-2007 were expressed in terms of number of servings to consume every day for the broad categories of foods: Vegetables and fruits, Grains, Dairy and Alternatives, and Meat and Alternatives (1, 2). The CFG-2007 recommended daily servings based on comprehensive diet simulations, thus ensuring that Dietary Reference Intakes (DRI) were met (2). The latest CFG (2019) adopted a different approach and primarily aims at chronic disease risk reduction (3-6). In addition, recommendations in CFG-2019 (e.g., “eat more often …”) are more flexible than those of CFG-2007 and rely on proportions of food categories to constitute a healthy plate, without recommended quantitative daily servings.</p>
<p>The release of the CFG-2019 elicited positive reactions (7, 8), but also raised concerns on nutrient adequacy. For example, preliminary modeling of eating patterns consistent with the CFG-2019 plate snapshot revealed that adherence may be insufficient to meet calcium and vitamin D requirements (9). The ability of consumers and policymakers to properly implement CFG-2019 recommendations on protein foods was also found unclear (10). In the Canadian Community Health Survey (CCHS) 2015 – Nutrition, animal-based protein foods contributed more than two thirds of total protein intake (11) as well as to overall nutrient intakes (12), which contrasts with CFG-2019 recommendations aiming at increasing intake of plant-based foods. Accordingly, following CFG-2019 recommendations while failing to include nutrient-dense foods and beverages could amplify the proportion of the population with inadequate nutrient intakes, especially for certain age groups at higher risk. In that regard, maintaining adequate nutrient intakes is a challenge for older adults (13, 14). Older adults face social (e.g., loneliness, inability to buy or prepare foods) and physiological (e.g., changes in taste, loss of appetite, malabsorption) barriers to consuming a nutrient-dense diet (14). Notably, calcium, vitamin D, fiber, potassium and protein were identified as nutrients of concern among older adults in the United States 2015 Dietary Guidelines report (15). Similarly, a high proportion of long-term care residents in Canada had inadequate calcium, folate, vitamin B6 and magnesium intakes (16). In sum, the one-size-fits-all recommendations in CFG-2019 may not be well-suited for older adults who face unique challenges to healthy eating compared with other strata of the population.</p>
<p>Whether adherence to CFG-2019 recommendations on healthy food choices fulfils nutritional needs of older Canadians is currently unknown; no evidence from contemporary eating patterns exists. The general aim of this study was therefore to assess the relationship between adherence to CFG-2019 recommendations, using the Healthy Eating Food Index-2019 (HEFI-2019) , and intakes of key nutrients from food sources only, of adults aged ≥65 years from the CCHS 2015 – Nutrition. The HEFI-2019 score is a metric measuring the alignment of eating patterns with CFG-2019 recommendations on food choices (17, 18). More precisely, we assessed 1) the continuous relationship between the HEFI-2019 score and nutrient intakes, and 2) the estimated change in the prevalence of nutrient inadequacy according to a hypothetical increase in HEFI-2019 score. We hypothesized that higher adherence to CFG-2019 recommendations would show an inverse relationship with intakes of nutrients more commonly found or eaten in animal-based foods, such as protein, calcium, vitamin D, iron, zinc, vitamin B6 and B12, and a positive relationship with intakes of nutrients more commonly found in plant-based foods such as fiber, folate, magnesium, potassium, vitamin A.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="materials-and-methods" class="level1">
<h1>Materials and Methods</h1>
<section id="study-design-and-participants" class="level2">
<h2 class="anchored" data-anchor-id="study-design-and-participants">Study Design and Participants</h2>
<p>This study is based on a sample of older adults aged 65 years or older from the CCHS 2015 – Nutrition (19). The CCHS 2015 -Nutrition is a nationally representative survey of individuals aged 1 year and older living in private dwellings in the 10 Canadian provinces. Full-time members of the Canadian Forces and individuals living in the Territories, on reserves, in remote areas, and in institutions were not included. Data collection occurred between January 1st to December 31, 2015. Respondents aged less than 65 years (n=16,394) and those reporting zero energy on their first 24-hour dietary recall intake were excluded (n=4), yielding a final sample of 4,089 respondents. The public use microdata file (PUMF) of CCHS 2015 – Nutrition was obtained from Statistics Canada.</p>
</section>
<section id="data-collection-and-dietary-assessment" class="level2">
<h2 class="anchored" data-anchor-id="data-collection-and-dietary-assessment">Data Collection and Dietary Assessment</h2>
<p>Interviewer-administered 24-hour dietary recalls were used to assess dietary intakes. The interviews were mostly (98%) conducted in person for the first 24-hour recall and by telephone for the second 24-hour recall. All 24-hour recall interviews were structured according to the Automated Multiple Pass Method (19). Portion size estimation of foods and beverages in plates, bowls, glasses and mugs was facilitated using a food booklet designed for the survey (19). All respondents completed one 24-hour recall and a subsample of 1,706 respondents (42%) completed a second 24-hour recall. Nutrient intakes were calculated based on the Canadian Nutrient File 2015 (20), except for intakes of free sugars which were recently published by Health Canada (21). Total food intakes expressed in reference amounts (RA) (22) were calculated for each respondent, 24-hour dietary recall and HEFI-2019 food and beverage categories. The interviewers measured body weight of respondents with a standard scale (LifeSource Scales Model US-321).</p>
<section id="the-healthy-eating-food-index-hefi-2019" class="level3">
<h3 class="anchored" data-anchor-id="the-healthy-eating-food-index-hefi-2019">The Healthy Eating Food Index (HEFI) 2019</h3>
<p>The HEFI-2019 is a continuous score which measures the degree of adherence between dietary intakes and Canada’s Food Guide 2019 recommendations on healthy food choices. Complete details about the development and the evaluation of the HEFI-2019 are available elsewhere (17, 18). Briefly, the HEFI-2019 has 10 components including 5 based on intake of foods (Vegetables and fruits, Whole-grain foods, Grain foods ratio, Protein foods, Plant-based protein foods), 1 on beverages (Beverages), and 4 on nutrients (Fatty acids ratio, Saturated fats, Free sugars, and Sodium). The Saturated fats, Free sugars and Sodium components are so-called “moderation” components, for which higher scores are attributed to intakes below thresholds consistent with CFG-2019 recommendations. The remaining components are “adequacy” components for which higher scores are attributed to greater intakes. Details about each component and scoring standards are presented in <strong>Supplemental Table 1</strong>. The total HEFI-2019 score sums up to 80 points with higher scores indicating greater adherence to recommendations. The HEFI-2019 was evaluated using dietary intake data from the CCHS 2015 – Nutrition (18). Notably, the variability of the HEFI-2019 score was sufficient, the HEFI-2019 score was correlated with the Healthy Eating Index (HEI)-2015 (r=0.79) and differences of HEFI-2019 score were found among subgroups with known diet quality differences based on sex, age, and smoking status (18). Finally, a prospective analysis of UK Biobank data suggested that a hypothetical increase in HEFI-2019 score reduces the 11-year risk of cardiovascular disease in middle-aged and older adults (6).</p>
</section>
<section id="nutrient-intakes" class="level3">
<h3 class="anchored" data-anchor-id="nutrient-intakes">Nutrient intakes</h3>
<p>Key nutrients for older adults were selected a priori according to data availability in the CCHS 2015 – Nutrition as well as previous literature (13, 23). The nutrients were protein, calcium, vitamin D, iron, zinc, vitamin B6, vitamin B12, dietary folate equivalent (folate hereafter), magnesium, potassium, fiber, and retinol activity equivalent (vitamin A hereafter). Nutrient intakes from supplements were not included since Canada’s Food Guide recommendations on healthy food choices focus on foods and beverages. The proportion of respondents with inadequate intakes was estimated using the cut-point method and the Estimated Average Requirements (EAR) of the Dietary Reference Intake (24). Because there is no EAR for potassium and fiber, the prevalence of intake inadequacy cannot be assessed. Instead, the proportion of respondents with intakes above the adequate intake (AI) value was considered.</p>
<p>Recognizing the consensus that recommended protein intakes for older adults should be higher than current recommendations (25-27), we also estimated the proportion of respondents with inadequate protein intakes at cut-offs higher than the current EAR. The hypothetical EAR cut-offs of 0.8 and 1.0 grams of protein per kg of bodyweight were selected to reflect hypothetical higher recommended daily allowance (RDA) of 1.0 and 1.2 g/kg, respectively. The latter analysis was not pre-specified and is considered exploratory.</p>
</section>
</section>
<section id="statistical-analyses" class="level2">
<h2 class="anchored" data-anchor-id="statistical-analyses">Statistical Analyses</h2>
<p>Sampling weights provided by Statistics Canada were used in all analyses to reflect the Canadian population of older adults in 2015 as well as bootstrap replicate weights for variance estimation. The sampling weights accounting for missing data on body weight were also used where appropriate. Analyses were performed in SAS Studio v3.8 (SAS Institute) and R version 4.2.2 (2022-10-31) (R Foundation for Statistical Computing).</p>
<p>To assess the relationship between the HEFI-2019 score and nutrient intakes, analyses involved four steps, detailed below:</p>
<ol type="1">
<li>measurement error correction of dietary intakes to estimate usual intakes using the National Cancer Institute (NCI) Markov Chain Monte Carlo (MCMC) multivariate method;</li>
<li>linear regression of continuous nutrient intakes on total HEFI-2019 scores;</li>
<li>logistic regression of the proportion of individuals below EAR on total HEFI-2019 scores; and,</li>
<li>variance estimation using bootstrap replicate weights provided by Statistics Canada.</li>
</ol>
<p>First, the 24-hour dietary recalls are mainly affected by within-individual random errors, which require correction to estimate distribution of intakes (28, 29). To account for correlated random errors of all dietary constituents of the HEFI-2019 (e.g., vegetables and fruits, free sugars) and those of nutrient intakes (e.g., protein), the NCI MCMC multivariate method was used (MULTIVAR_MCMC_MACRO_V2.1 and MULTIVAR_DISTRIB_MACRO_V2.1, 2017) (30, 31). Briefly, the multivariate method uses Monte Carlo simulation to estimate distribution of usual intakes (i.e., long-term average) of multiple dietary constituents correlated with each other. The multivariate method also accounts for systematic differences due to “nuisance” factors (day of the week, sequence of recall) and considers foods that are episodically consumed (e.g., plant-based protein foods) (30).</p>
<p>Nutrients with common food sources were modelled together to have parsimonious measurement error correction models, yielding 5 different models each combining 1 to 4 nutrients with the 15 dietary constituents of the HEFI-2019 (see below). Model 1 included protein only; model 2 included calcium and vitamin D; model 3 included iron, zinc, vitamin B6 and vitamin B12; model 4 included folate, magnesium, potassium and fiber; model 5 included vitamin A only. The 15 dietary constituents of the HEFI-2019 were vegetables and fruits, whole-grain foods, animal-based protein foods, plant-based protein foods, unsweetened milk, water and other healthy beverages (e.g., unsweetened coffee or tea), refined grain foods, “other” foods not recommended, “other” beverages not recommended (i.e., sugary drinks, artificially sweetened beverages, vegetable and fruit juices, sweetened milk and plant-based beverages, alcohol), free sugars, monounsaturated fats, polyunsaturated fats, saturated fats, sodium and total energy intake. A total of 5 food and beverage categories (i.e., whole-grain foods, refined grain foods, plant-based protein foods, “other” beverages not recommended and unsweetened milk) were considered episodically consumed since at least 10% of respondents reported zero consumption on the first 24-h recall (31). All the remaining foods and nutrients were considered as consumed daily.</p>
<p>The measurement error correction models were stratified by sex to reflect sex-specific random variations in dietary intakes and to derive sex-specific associations (31, 32). The models also included the covariates age (indicator for 71 years or older), sequence of recall (indicator for second recall) and weekend (indicator for a 24-hour recall of intakes on Friday, Saturday or Sunday). In addition, the model for protein intake also included body weight (kg) as a covariate to derive protein intake per kg and assess the proportion of individuals below the EAR. A total of 500 pseudo-individuals were generated in the Monte Carlo simulation step of the NCI multivariate method. Simulations from each stratum (i.e., males and females) were pooled together. The HEFI-2019 scoring algorithm was then applied using the modelled dietary constituents among the 500 pseudo-individuals to derive HEFI-2019 scores. Descriptive statistics were calculated based on usual intakes among the 500 pseudo-individuals including the prevalence of intake inadequacy, mean (SD) dietary intakes and HEFI-2019 scores as well as correlations between dietary constituents of the HEFI-2019 and nutrient intakes.</p>
<p>Second, based on the Monte Carlo simulation data, simple linear regression models were used to assess the relationship between the continuous HEFI-2019 score, as the independent variable, and continuous nutrient intakes, as the dependent variable. A restricted cubic spline transformation with 5 knots (percentiles 5, 27, 50, 73 and 95) was applied a priori to the HEFI-2019 score to assess potential non-linearity (33). To estimate change according to feasible increases in adherence, expected nutrient intake differences were calculated according to an increase in HEFI-2019 score from the median score to the 90<sup>th</sup> percentile of the usual intake distribution. In other words, we estimated nutrient intake difference according to a hypothetical change where respondents would have had high HEFI-2019 scores compared with the HEFI-2019 score respondents had on average, taken as the median of this sample.</p>
<p>Third, also based on the Monte Carlo simulation data, logistic regression models were used to assess the odds of having nutrient intake below the age- and sex-specific EAR and the continuous HEFI-2019 score. A restricted cubic spline transformation was also applied to the HEFI-2019 score. Predicted odds of nutrient intake inadequacy were generated for the 90<sup>th</sup> percentile and the median. Both predicted odds were then re-expressed as risk of inadequacy (<span class="math inline">\(\text{risk}=\frac{e^X}{(1+e^X)}\)</span>); where <span class="math inline">\(X\)</span> corresponds to predicted odds at a given HEFI-2019 score percentile). The expected change in the prevalence of inadequate nutrient intakes, i.e., risk difference, was calculated by the difference between the estimated risk of inadequacy at the 90<sup>th</sup> percentile vs.&nbsp;the median HEFI-2019 score.</p>
<p>Fourth, steps 1 to 3 were repeated 500 times using bootstrap replicate weights to generate standard errors and 95%CI via normal approximation. The convergence of bootstrap standard errors and the normality of bootstrap estimates were confirmed graphically. Data from one bootstrap replicate was removed for potassium due to non-convergence.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<section id="hefi-2019-score-and-dietary-constituents" class="level2">
<h2 class="anchored" data-anchor-id="hefi-2019-score-and-dietary-constituents">HEFI-2019 Score and Dietary Constituents</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#               Import SAS data of HEFI-2019 distribution                 #</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>hefi_distrib_all <span class="ot">&lt;-</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_score'</span>, <span class="st">'Results'</span>, <span class="st">'distribtotal_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">varname=</span><span class="st">"HEFI2019_TOTAL_SCORE"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">mean_sd =</span> <span class="fu">makeEstimate</span>(Mean,StdDev)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>hefi_distrib_drig <span class="ot">&lt;-</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_score'</span>, <span class="st">'Results'</span>, <span class="st">'distribtotal_w_drig0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">&lt;</span><span class="dv">9000</span>) <span class="sc">|&gt;</span> <span class="co"># remove score differences among DRI groups</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Contrast) <span class="sc">|&gt;</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_sd =</span> <span class="fu">makeEstimate</span>(Mean,StdDev)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># append both</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>hefi_distrib <span class="ot">&lt;-</span> </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(hefi_distrib_all,hefi_distrib_drig)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>hefi_distrib<span class="sc">$</span>drigf <span class="ot">&lt;-</span> </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(hefi_distrib<span class="sc">$</span>drig,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span>drig_list,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels=</span>drig_label)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co"># clean temporary data</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(hefi_distrib_all)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(hefi_distrib_drig)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co"># output ordered list</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  hefi_distrib_orderd <span class="ot">&lt;-</span> </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    hefi_distrib <span class="sc">|&gt;</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(Mean)) <span class="sc">|&gt;</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Mean,StdDev,mean_sd,drig,drigf)</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="co">#             Plot score distribution using density function              #</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Make long data to plot distrib</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>hefi_distrib_t <span class="ot">&lt;-</span> </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  hefi_distrib <span class="sc">|&gt;</span> </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(drig,drigf,Pctile1<span class="sc">:</span>Pctile99) <span class="sc">|&gt;</span> </span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>   <span class="at">cols=</span> Pctile1<span class="sc">:</span>Pctile99</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">'Pctile'</span>,<span class="st">''</span>,name))</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a><span class="co"># save data for future analyses</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>( hefi_distrib_t,</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"hefi_distrib_t.rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The mean (SD) HEFI-2019 score among all adults 65 years and older was 46.0 (8.9) (/80 points). Among age and sex subgroups, the mean HEFI-2019 score was the highest in females, 65 to 70 y (48.2 points) and the lowest in males, 65 to 70 y (44.9 points; <a href="#fig-hefi-distrib">Figure&nbsp;1</a>).</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#               Plot score distribution using Box+Density                 #</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">load</span>(<span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"mrg_all.rdata"</span>))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># generate figure </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>hefi_distrib_plot <span class="ot">&lt;-</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  hefi_distrib_t <span class="sc">|&gt;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample=</span><span class="fu">ifelse</span>(drig<span class="sc">==</span><span class="dv">0</span>,<span class="st">"All"</span>,<span class="st">"By DRI group"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot call</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># half density</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>      ggdist<span class="sc">::</span><span class="fu">stat_slab</span>(<span class="fu">aes</span>(<span class="at">y =</span> drigf, <span class="at">x =</span> value, <span class="co">#fill = drigf</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                            ), <span class="at">fill=</span><span class="st">"gray"</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">side =</span> <span class="st">"right"</span>, <span class="at">justification=</span><span class="sc">-</span><span class="fl">0.15</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="fl">0.75</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Box plot</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_boxplot</span>(<span class="at">data=</span><span class="fu">subset</span>(hefi_distrib, drig<span class="sc">&gt;</span><span class="dv">0</span>),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">y=</span>drigf,<span class="at">xlower=</span>Pctile25,<span class="at">xupper=</span>Pctile75,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmiddle=</span>Pctile50,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmin=</span>Pctile5, <span class="at">xmax=</span>Pctile95,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#fill = drigf</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                       ), <span class="at">fill=</span><span class="st">"white"</span>,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">width=</span> .<span class="dv">2</span>, <span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Diamond for mean</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">subset</span>(hefi_distrib, drig<span class="sc">&gt;</span><span class="dv">0</span>),</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x =</span> Mean,<span class="at">y=</span>drigf),<span class="at">shape=</span><span class="dv">18</span>, <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"HEFI-2019 score based on usual intakes (/80), points"</span>,</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Age and sex group"</span>) <span class="sc">+</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Show figure</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>hefi_distrib_plot</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="co">#            Export graph as PDF/PNG             #</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(ms_dir, <span class="st">'Fig1_hefi_distrib.pdf'</span>),</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot=</span>hefi_distrib_plot, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">7</span>,<span class="at">height=</span><span class="dv">7</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="dv">1</span>,<span class="at">device =</span> cairo_pdf)</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(ms_dir, <span class="st">'Fig1_hefi_distrib.png'</span>),</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot=</span>hefi_distrib_plot, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">7</span>,<span class="at">height=</span><span class="dv">7</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-hefi-distrib" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="9.1-HEFI19-NUT_ARTICLE_files/figure-html/fig-hefi-distrib-1.png" class="quarto-discovered-preview-image img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Distribution of total HEFI-2019 score, based on usual dietary intakes in 4,089 adults aged 65 years and more from the CCHS 2015 - Nutrition. Diamonds are means. Left and right whiskers indicate the 5th and 95th percentile, respectively. Dietary intakes were modelled using the National Cancer Institute multivariate method to estimate usual intakes (see Methods). CCHS, Canadian Community Health Survey; DRI, Dietary Reference Intake; HEFI-2019, Healthy Eating Food Index-2019.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                 MCMC data of HEFI dietary constituents                  #</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Read mcmc data and save as &lt;rds&gt; for efficiency purpose</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">file.exists</span>(<span class="fu">file.path</span>(res_dir,<span class="st">"usintake_mc_t_out0.rds"</span>))<span class="sc">==</span><span class="cn">FALSE</span>){</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## record time</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  tictoc<span class="sc">::</span><span class="fu">tic</span>(<span class="at">msg =</span> <span class="st">"loading &lt;NCI/MCMC_score/Model/_usintake_mc_t_out0.sas7bdat&gt;"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## read mcmc data on external drive once, write as .rds file for future use</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path, <span class="st">'NCI'</span>, <span class="st">'MCMC_score'</span>, <span class="st">'Model'</span>, <span class="st">'_usintake_mc_t_out0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="do">### drop some variables as only dietary intake data used here</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(weight_nw_sumw, <span class="fu">starts_with</span>(<span class="st">"HEFI"</span>), <span class="fu">starts_with</span>(<span class="st">"RATIO"</span>),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>              catscore, <span class="fu">starts_with</span>(<span class="st">"Prob"</span>), energy_unit)) <span class="sc">|&gt;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"usintake_mc_t_out0.rds"</span>))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## show time</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  tictoc<span class="sc">::</span><span class="fu">toc</span>()</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="do">## file already exists, do nothing else</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"note: &lt;usintake_mc_t_out0.rds&gt; data found in &lt;./Data/Results/&gt;"</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># note: the SAS format &lt;.sas7bdat&gt; produces ~ 1.5-folder larger data</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co"># read rds file, prepare</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>mcmc <span class="ot">&lt;-</span> </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"usintake_mc_t_out0.rds"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(weight_nw_sumw_div, wg, rg, pfab, pfpb, milk) <span class="sc">|&gt;</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># grain sources</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_wg_total =</span> wg <span class="sc">/</span> (wg<span class="sc">+</span>rg), </span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># protein sources</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">milk_ra    =</span> milk<span class="sc">/</span><span class="dv">258</span>,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">pro_total  =</span> pfab <span class="sc">+</span> pfpb <span class="sc">+</span> milk_ra,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">pro_animal =</span> pfab <span class="sc">+</span> milk_ra,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_proanimal_total =</span> pro_animal <span class="sc">/</span> pro_total</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co">#          Output statistic of interest          #</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>ratio_wg_total <span class="ot">&lt;-</span> </span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(mcmc, stats<span class="sc">::</span><span class="fu">weighted.mean</span>(<span class="at">x =</span> ratio_wg_total,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">w =</span> weight_nw_sumw_div))</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>ratio_proanimal_total <span class="ot">&lt;-</span> </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(mcmc, stats<span class="sc">::</span><span class="fu">weighted.mean</span>(<span class="at">x =</span> ratio_proanimal_total,</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">w =</span> weight_nw_sumw_div))</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="co"># clean temporary large file</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(mcmc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Supplemental Table 2 and 3</strong> present, respectively, usual mean intakes and percentile of the distribution of foods and beverages, as well as nutrients, contributing to the HEFI-2019 score. Older adults consumed approximately 86% of their total protein foods from animal-based source and 65% of their total grain foods intake as non-whole grain foods.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Apply function on each nutrients                     #</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Load data, estimate correlations and save results</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># note: &lt;read_n_corr&gt; located in &lt;./Macros/post_mcmc_auxiliary.R&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># note: if needed, could apply a &lt;purrr&gt; loop to obtain bootstrap sampling distribution</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">file.exists</span>(<span class="fu">file.path</span>(res_dir,<span class="st">"suppl_corr.rdata"</span>))<span class="sc">==</span><span class="cn">FALSE</span>){</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>corr_pro <span class="ot">&lt;-</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_n_corr</span>(<span class="at">nut_vars  =</span> <span class="st">"proteins"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">nut_label =</span> <span class="st">"pro"</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">tidy      =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>corr_ca_vitd <span class="ot">&lt;-</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_n_corr</span>(<span class="at">nut_vars  =</span> <span class="fu">c</span>(<span class="st">"calcium"</span>, <span class="st">"vit_d"</span>),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">nut_label =</span> <span class="st">"ca_vit_d"</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">tidy      =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>corr_miscA <span class="ot">&lt;-</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_n_corr</span>(<span class="at">nut_vars  =</span> <span class="fu">c</span>(<span class="st">"iron"</span>, <span class="st">"zinc"</span>, <span class="st">"vit_b6"</span>, <span class="st">"vit_b12"</span>),</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">nut_label =</span> <span class="st">"miscA"</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">tidy      =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>corr_miscB <span class="ot">&lt;-</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_n_corr</span>(<span class="at">nut_vars  =</span> <span class="fu">c</span>(<span class="st">"dfe"</span>, <span class="st">"mg"</span>, <span class="st">"fibers"</span>, <span class="st">"pota"</span>),</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">nut_label =</span> <span class="st">"miscB"</span>,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">tidy      =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>corr_vita <span class="ot">&lt;-</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_n_corr</span>(<span class="at">nut_vars  =</span> <span class="fu">c</span>(<span class="st">"vit_a"</span>),</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">nut_label =</span> <span class="st">"vit_a"</span>,</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">tidy      =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>suppl_corr <span class="ot">&lt;-</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(corr_pro,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>            corr_ca_vitd) <span class="sc">|&gt;</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(corr_miscA) <span class="sc">|&gt;</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(corr_miscB) <span class="sc">|&gt;</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(corr_vita) <span class="sc">|&gt;</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rae =</span> vit_a )</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Save correlation data for further analyses</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(suppl_corr,</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"suppl_corr.rdata"</span>))</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="co"># load corr data regardless</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"suppl_corr.rdata"</span>))</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="co">#                Data preparation                #</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Transpose from wide to long</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>suppl_corr_t <span class="ot">&lt;-</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  suppl_corr <span class="sc">|&gt;</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># drop identifier</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(replicate, index, name)) <span class="sc">|&gt;</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># transpose</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(suppl_corr<span class="sc">$</span>name) </span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Add nutrient names</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>suppl_corr_t<span class="sc">$</span>nutrient <span class="ot">&lt;-</span> <span class="fu">names</span>(suppl_corr)[<span class="dv">4</span><span class="sc">:</span><span class="dv">15</span>]</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of HEFI foods</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>  hefi_foods <span class="ot">&lt;-</span> </span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">'vf'</span>, <span class="st">'wg'</span>, <span class="st">'pfab'</span>, <span class="st">'pfpb'</span>, <span class="st">'milk'</span>, <span class="st">'water'</span>, <span class="st">'otherbevs'</span>, <span class="st">'rg'</span>, <span class="st">'otherfoods'</span>)</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the &lt;_res&gt; suffix for easy id</span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>  hefi_foods_res <span class="ot">&lt;-</span> </span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(hefi_foods,<span class="st">"_res"</span>)</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data for correlation heatmap: 'melt'</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>suppl_corr_t_melted <span class="ot">&lt;-</span> </span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>  suppl_corr_t <span class="sc">|&gt;</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nutrient,<span class="fu">all_of</span>(hefi_foods_res)) <span class="sc">|&gt;</span> <span class="co"># select components only</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>  reshape2<span class="sc">::</span><span class="fu">melt</span>()</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a><span class="co">#                  Nicer labels                  #</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a><span class="co"># order values and add 'clean' labels</span></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>suppl_corr_t_melted<span class="sc">$</span>nutrient_f <span class="ot">&lt;-</span></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(suppl_corr_t_melted<span class="sc">$</span>nutrient,</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels =</span><span class="fu">c</span>(<span class="st">'proteins'</span>, </span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'calcium'</span>, </span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'vit_d'</span>, </span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'iron'</span>, </span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'zinc'</span>, </span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'vit_b6'</span>, </span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'vit_b12'</span>, </span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'dfe'</span>, </span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'mg'</span>, </span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'fibers'</span>, </span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'pota'</span>, </span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'rae'</span>),</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels  =</span><span class="fu">c</span>(<span class="st">'Protein'</span>, </span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Calcium'</span>, </span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Vitamin D'</span>, </span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Iron'</span>, </span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Zinc'</span>, </span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Vitamin B6'</span>, </span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Vitamin B12'</span>, </span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Folate'</span>, </span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Magnesium'</span>, </span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Fiber'</span>, </span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Potassium'</span>, </span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Vitamin A'</span>))</span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>suppl_corr_t_melted<span class="sc">$</span>variable_f <span class="ot">&lt;-</span></span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(suppl_corr_t_melted<span class="sc">$</span>variable,</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'vf_res'</span>,</span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'wg_res'</span>,</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'pfab_res'</span>,</span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'pfpb_res'</span>,</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'milk_res'</span>,</span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'water_res'</span>,</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'otherbevs_res'</span>,</span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'rg_res'</span>,</span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'otherfoods_res'</span>),</span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Vegetables and fruits'</span>,</span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Whole-grain foods'</span>,</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Animal protein foods'</span>,</span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Plant protein foods'</span>,</span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Unsweetened milk'</span>,</span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Water &amp; healthy bev.'</span>,</span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Other beverages'</span>,</span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Non-whole grains'</span>,</span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Other foods'</span>))</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a><span class="co"># save for further analyses</span></span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(suppl_corr_t_melted,</span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">file.path</span>(res_dir, <span class="st">"suppl_corr_t_melted.rdata"</span>))</span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a><span class="co">#                 Interpretation                 #</span></span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a>corr_text <span class="ot">&lt;-</span> </span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a>  suppl_corr_t_melted <span class="sc">|&gt;</span></span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trick to keep upper case in nutrient names</span></span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">nutrient_f_lowcase =</span> <span class="fu">lapply</span>(nutrient_f,<span class="cf">function</span>(x) <span class="fu">str_replace</span>(x, <span class="st">"^</span><span class="sc">\\</span><span class="st">w{1}"</span>, tolower)) ,</span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create text of foods/nutrient + correlation estimate</span></span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">relation =</span> <span class="fu">paste</span>(<span class="fu">tolower</span>(variable_f),<span class="st">"and"</span>, nutrient_f_lowcase),</span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">paste0</span>(<span class="st">"(r="</span>,scales<span class="sc">::</span><span class="fu">number</span>(value,<span class="at">accuracy=</span><span class="fl">0.01</span>),<span class="st">")"</span>),</span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">nutrient_n_estimate =</span> <span class="fu">paste</span>(nutrient_f_lowcase,estimate),</span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">relation_n_estimate =</span> <span class="fu">paste</span>(relation,estimate),</span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a>    <span class="co"># flag food categories not recommended in CFG</span></span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">not_recommended_CFG =</span> <span class="fu">ifelse</span>(variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"otherbevs_res"</span>,<span class="st">"rg_res"</span>,<span class="st">"otherfoods_res"</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>nutrient_f_lowcase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Supplemental Figure 1</strong> presents Pearson correlations between food and beverage categories contributing to the HEFI-2019 score and key nutrients. Most food and beverage categories recommended in CFG 2019 were correlated with greater nutrient intakes. Notably, the highest correlations were observed between unsweetened milk and calcium (r=0.56), vegetables and fruits and fiber (r=0.54), whole-grain foods and fiber (r=0.54) as well as unsweetened milk and vitamin D (r=0.53). Among foods and beverages not recommended in CFG, non-whole grain foods was the only group showing positive correlations with nutrient intakes including with folate (r=0.16) and with vitamin D (r=0.12).</p>
</section>
<section id="prevalence-of-inadequate-nutrient-intake" class="level2">
<h2 class="anchored" data-anchor-id="prevalence-of-inadequate-nutrient-intake">Prevalence of Inadequate Nutrient Intake</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#            Distribution of usual intakes for each nutrient              #</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define variables to keep in each distribution data</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>distrib_var <span class="ot">&lt;-</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"drig"</span>,<span class="st">"varname"</span>,<span class="st">"Mean"</span>,<span class="st">"StdDev"</span>,<span class="st">"Variance"</span>, <span class="fu">paste0</span>(<span class="st">"Pctile"</span>,<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">99</span>)))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#            Import nutrient distrib             #</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>distrib_pro <span class="ot">&lt;-</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_abs_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) <span class="sc">|&gt;</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_rel_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>distrib_cavitd <span class="ot">&lt;-</span> </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcium</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_ca_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) <span class="sc">|&gt;</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vitamin D</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_vitd_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var))</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>distrib_miscA <span class="ot">&lt;-</span> </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iron</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  (haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_iron_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) <span class="sc">|&gt;</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Zinc</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_zinc_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) <span class="sc">|&gt;</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vitamin B6</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_b6_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) )  <span class="sc">|&gt;</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vitamin B12</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_b12_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) </span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>distrib_miscB <span class="ot">&lt;-</span> </span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Folate</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  (haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_dfe_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) <span class="sc">|&gt;</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Magnesium</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_mg_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) <span class="sc">|&gt;</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fiber</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_fib_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) )  <span class="sc">|&gt;</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Potassium</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_pota_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var) ) </span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>distrib_vita <span class="ot">&lt;-</span> </span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vitamin A (RAE)</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_rae_w0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>distrib_var)</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a><span class="co">#            Append nutrient distrib             #</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>distrib_y <span class="ot">&lt;-</span> </span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(distrib_pro,distrib_cavitd,</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>        distrib_miscA,distrib_miscB,</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>        distrib_vita) <span class="sc">|&gt;</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename protein variable for consistency</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">ifelse</span>(varname<span class="sc">==</span><span class="st">"proteins"</span>,<span class="st">"pro"</span>,varname),</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">ifelse</span>(varname<span class="sc">==</span><span class="st">"proteins_kg"</span>,<span class="st">"pro_kg"</span>,varname)</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>   <span class="do">## add labels </span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>    distrib_y<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(distrib_y<span class="sc">$</span>varname,</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> varname_list,</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> varlabel_list</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>    distrib_y<span class="sc">$</span>drig_f <span class="ot">&lt;-</span> </span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(distrib_y<span class="sc">$</span>drig,</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> drig_list,</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> drig_label</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># clean</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"distrib_pro"</span>,<span class="st">"distrib_cavitd"</span>,<span class="st">"distrib_miscA"</span>,<span class="st">"distrib_miscB"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ************************************************************************ #</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                 Import SAS data on marginal Pr(X&lt;EAR)                    #</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ************************************************************************ #</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: mrg, marginal (crude population average)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Protein                     #</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>mrg_pro <span class="ot">&lt;-</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_rel_wf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Hardcoded value for Pr(X&lt;EAR)</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"Prob1"</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient identifier</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"pro"</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#             Calcium and Vitamin D              #</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>mrg_cavitd <span class="ot">&lt;-</span> </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_wf.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="fu">grep</span>(<span class="st">"EAR"</span>,name)) </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#         Iron, Zinc, Vit. B6, Vit. B12          #</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>mrg_miscA <span class="ot">&lt;-</span> </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_wf.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="fu">grep</span>(<span class="st">"EAR"</span>,name)) </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co">#        Dietary Folate Eq, Mg, K, Fibers        #</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>mrg_miscB <span class="ot">&lt;-</span> </span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_wf.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="fu">grep</span>(<span class="st">"EAR"</span>,name)) </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="co">#                Vitamin A (RAE)                 #</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>mrg_rae <span class="ot">&lt;-</span> </span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'distrib_y_wf.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="fu">grep</span>(<span class="st">"EAR"</span>,name)) </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co">#            Append nutrient distrib             #</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>mrg_all <span class="ot">&lt;-</span> </span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(mrg_pro,mrg_cavitd,</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>        mrg_miscA,mrg_miscB,</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>        mrg_rae) <span class="sc">|&gt;</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: fibers and potassium (Pr(X&lt;Adequate Intake)) cannot appear here, since cut-point is not EAR</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span>(varname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fibers"</span>,<span class="st">"pota"</span>))</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="do">## add labels </span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>mrg_all<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(mrg_all<span class="sc">$</span>varname,</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels =</span> varname_list,</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> varlabel_list )</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a><span class="do">## remove units</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>mrg_all <span class="ot">&lt;-</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>  mrg_all <span class="sc">|&gt;</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>   <span class="co"># remove units from &lt;varname_f&gt;</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> varname_f,</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"varname_f"</span>,<span class="st">"unit"</span>),</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">', '</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a><span class="co"># clean temporary </span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a> <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"mrg_pro"</span>,<span class="st">"mrg_cavitd"</span>,<span class="st">"mrg_miscA"</span>,<span class="st">"mrg_miscB"</span>,<span class="st">"mrg_rae"</span>))</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a> mrg_all_drig0_ordered <span class="ot">&lt;-</span> </span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>   mrg_all <span class="sc">|&gt;</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(estimate)) </span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a> <span class="co"># save data for further analyses</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a> <span class="fu">save</span>(mrg_all, <span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"mrg_all.rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The prevalence of inadequate nutrient intakes ranged from 1% (iron) to 96% (vitamin D; <a href="#fig-mrg-prob-all">Figure&nbsp;2</a>). The prevalence of inadequate intakes was high for vitamin D, calcium, and magnesium (96%, 83%, 64%, respectively) and moderately high for vitamin B6, vitamin A, folate, and zinc (38%, 36%, 30%, 28%, respectively; <a href="#fig-mrg-prob-all">Figure&nbsp;2</a>). Results were similar for most nutrients when stratified by DRI age and sex group (<strong>Supplemental Table 4</strong>).</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#              Make dot plot of Pr(X&lt;EAR), all respondents                #</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">load</span>(<span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"mrg_all.rdata"</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># generate figure </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>mrg_prob_plot_all <span class="ot">&lt;-</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  mrg_all <span class="sc">|&gt;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(varname_f,estimate,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="at">y=</span>estimate)) <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lcl95, <span class="at">ymax=</span>ucl95), <span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>estimate_ci, <span class="at">fontface=</span><span class="st">"bold"</span>),<span class="at">color=</span><span class="st">"BLACK"</span>,<span class="at">size=</span><span class="dv">3</span>,<span class="at">nudge_x =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Nutrients"</span>,<span class="at">y=</span><span class="st">"Prevalence of inadequacy, %"</span>) <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="sc">+</span> </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dotplotx</span>() <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Show figure</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>mrg_prob_plot_all</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#            Export graph as PDF/PNG             #</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(ms_dir,<span class="st">"Fig2_prob_ear.pdf"</span>),</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot=</span>mrg_prob_plot_all, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">7</span>,<span class="at">height=</span><span class="dv">5</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="fl">1.05</span>,<span class="at">device =</span> cairo_pdf)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(ms_dir,<span class="st">"Fig2_prob_ear.png"</span>),</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot=</span>mrg_prob_plot_all, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">7</span>,<span class="at">height=</span><span class="dv">5</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="fl">1.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mrg-prob-all" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="9.1-HEFI19-NUT_ARTICLE_files/figure-html/fig-mrg-prob-all-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Prevalence of inadequate nutrient intakes in 4,089 adults aged 65 years and older from the CCHS 2015 - Nutrition. Only nutrient intakes from foods were considered (i.e., excluding intakes from dietary supplement). Inadequate intakes are intakes below the age- and sex-specific Estimated Average Requirements (EAR). Potassium and fiber are not shown, because only Adequate Intakes (AI) values are available for these nutrients. All dietary intakes were modelled using the National Cancer Institute multivariate method to estimate usual intakes (see Methods). 95%CI were estimated using 500 bootstrap weight replicates. CCHS, Canadian Community Health Survey.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="relationship-between-the-hefi-2019-score-and-nutrient-intakes" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-the-hefi-2019-score-and-nutrient-intakes">Relationship between the HEFI-2019 Score and Nutrient Intakes</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#         Import SAS data - linear regression estimates and plot          #</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Protein                     #</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>linreg_plot_pro <span class="ot">&lt;-</span> </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'lin_plot_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">pred_id=</span><span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"pred"</span>,<span class="st">""</span>,name))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'lin_plot_drigf.sas7bdat'</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"pro"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#             Calcium and Vitamin D              #</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>linreg_plot_catvitd <span class="ot">&lt;-</span> </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'lin_plot_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'lin_plot_drigf.sas7bdat'</span>),</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_select =</span> <span class="sc">-</span>(<span class="st">`</span><span class="at">_MergeError_</span><span class="st">`</span>))</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co">#         Iron, Zinc, Vit. B6, Vit. B12          #</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>linreg_plot_miscA <span class="ot">&lt;-</span> </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'lin_plot_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'lin_plot_drigf.sas7bdat'</span>),</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_select =</span> <span class="sc">-</span>(<span class="st">`</span><span class="at">_MergeError_</span><span class="st">`</span>))</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="co">#        Dietary Folate Eq, Mg, K, Fibers        #</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>linreg_plot_miscB <span class="ot">&lt;-</span> </span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'lin_plot_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'lin_plot_drigf.sas7bdat'</span>),</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_select =</span> <span class="sc">-</span>(<span class="st">`</span><span class="at">_MergeError_</span><span class="st">`</span>))</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig)</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a><span class="co">#                Vitamin A (RAE)                 #</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>linreg_plot_rae <span class="ot">&lt;-</span> </span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'lin_plot_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'lin_plot_drigf.sas7bdat'</span>),</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_select =</span> <span class="sc">-</span>(<span class="st">`</span><span class="at">_MergeError_</span><span class="st">`</span>))</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig)</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Append all nutrient, remove useless variables  #</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>linreg_plot_all <span class="ot">&lt;-</span> </span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(linreg_plot_pro,linreg_plot_catvitd,</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>        linreg_plot_miscA,linreg_plot_miscB,</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>        linreg_plot_rae) <span class="sc">|&gt;</span> </span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(name,alpha,one_minus_half_alpha,</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>            t_quant,tvalue,pvalue,svalue,<span class="st">`</span><span class="at">_ci</span><span class="st">`</span>,<span class="st">`</span><span class="at">_se</span><span class="st">`</span>,</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>            estimate_se))</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"linreg_plot_pro"</span>,</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_plot_catvitd"</span>,</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_plot_miscA"</span>,</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_plot_miscB"</span>,</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_plot_rae"</span>))</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a><span class="do">## add labels </span></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>linreg_plot_all<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(linreg_plot_all<span class="sc">$</span>varname,</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels =</span> varname_list,</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> varlabel_list</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>linreg_plot_all<span class="sc">$</span>drig_f <span class="ot">&lt;-</span> </span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(linreg_plot_all<span class="sc">$</span>drig,</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels =</span> drig_list,</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> drig_label</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(linreg_plot_all,</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"linreg_plot_all.rdata"</span>))</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a><span class="co">#    Output subsample of observations from all mc_t_distrib_out data      #</span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a><span class="co"># wrap import into function (note: lengthy step due to large mc_t data)</span></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>mc_t_import <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: we use the &lt;slice_mc_t_out&gt; for consistent output</span></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Import HEFI + nutrient intake by MCMC models</span></span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>  mc_t_pro <span class="ot">&lt;-</span> </span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_mc_t_out</span>(<span class="at">nutrient=</span><span class="st">"proteins"</span>,</span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nutrient_label =</span> <span class="st">"pro"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">estimate=</span>proteins) <span class="sc">|&gt;</span> </span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"pro"</span>)</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>    <span class="co">#note: &lt;pivot_longer&gt; not used here since pro has only 1 variable</span></span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>  mc_t_cavitd <span class="ot">&lt;-</span> </span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_mc_t_out</span>(<span class="at">nutrient=</span><span class="fu">c</span>(<span class="st">"calcium"</span>,<span class="st">"vit_d"</span>),</span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nutrient_label =</span> <span class="st">"ca_vit_d"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="st">"calcium"</span>,<span class="st">"vit_d"</span>),</span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">"varname"</span>,</span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">"estimate"</span>)</span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>  mc_t_miscA <span class="ot">&lt;-</span> </span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_mc_t_out</span>(<span class="at">nutrient=</span><span class="fu">c</span>(<span class="st">"iron"</span>,<span class="st">"zinc"</span>,<span class="st">"vit_b6"</span>,<span class="st">"vit_b12"</span>),</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nutrient_label =</span> <span class="st">"miscA"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="st">"iron"</span>,<span class="st">"zinc"</span>,<span class="st">"vit_b6"</span>,<span class="st">"vit_b12"</span>),</span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">"varname"</span>,</span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">"estimate"</span>)</span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a>    mc_t_miscB <span class="ot">&lt;-</span> </span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_mc_t_out</span>(<span class="at">nutrient=</span><span class="fu">c</span>(<span class="st">"dfe"</span>,<span class="st">"mg"</span>,<span class="st">"fibers"</span>,<span class="st">"pota"</span>),</span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nutrient_label =</span> <span class="st">"miscB"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="st">"dfe"</span>,<span class="st">"mg"</span>,<span class="st">"fibers"</span>,<span class="st">"pota"</span>),</span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">"varname"</span>,</span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">"estimate"</span>)</span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a>  mc_t_rae <span class="ot">&lt;-</span> </span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_mc_t_out</span>(<span class="at">nutrient=</span><span class="st">"rae"</span>,</span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nutrient_label =</span> <span class="st">"vit_a"</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">estimate=</span>rae) <span class="sc">|&gt;</span> </span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"rae"</span>)</span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Append all</span></span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>  mc_t_subset <span class="ot">&lt;-</span></span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rbind</span>(mc_t_pro,mc_t_cavitd,</span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>          mc_t_miscA,mc_t_miscB,</span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>          mc_t_rae) </span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a>   <span class="do">## add labels </span></span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a>    mc_t_subset<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(mc_t_subset<span class="sc">$</span>varname,</span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> varname_list,</span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> varlabel_list</span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a>    mc_t_subset<span class="sc">$</span>drig_f <span class="ot">&lt;-</span> </span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(mc_t_subset<span class="sc">$</span>drig,</span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> drig_list,</span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> drig_label</span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a>    <span class="do">## indicate output data</span></span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>    mc_t_subset<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save</span></span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(mc_t_subset,</span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a>       <span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"mc_t_subset.rdata"</span>))</span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a><span class="co">#      Import and/or load mc_t subset data       #</span></span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a><span class="co"># run function only if &lt;mc_t_subset&gt; data not available</span></span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>( <span class="fu">file.exists</span>(<span class="fu">file.path</span>(res_dir,<span class="st">"mc_t_subset.rdata"</span>))<span class="sc">==</span><span class="cn">FALSE</span>){</span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a>  tictoc<span class="sc">::</span><span class="fu">tic</span>(<span class="at">msg =</span> <span class="st">"loading and sampling &lt;NCI/MCMC_*/Model/mc_t_distrib_out0.sas7bdat&gt;"</span> )</span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mc_t_import</span>()</span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a>  tictoc<span class="sc">::</span><span class="fu">toc</span>()</span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a><span class="co"># load data in any case</span></span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">file.path</span>(res_dir,<span class="st">"mc_t_subset.rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#               Output reg. coef. estimate for t1t0 diff.                 #</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: difference can either be presented in table, used to sort graph or both</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Protein                     #</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>linreg_beta_pro <span class="ot">&lt;-</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_drigf.sas7bdat'</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"pro"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">!=</span><span class="st">"r2"</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">#             Calcium and Vitamin D              #</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>linreg_beta_catvitd <span class="ot">&lt;-</span> </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group </span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_drigf.sas7bdat'</span>))</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">!=</span><span class="st">"r2"</span>)</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co">#         Iron, Zinc, Vit. B6, Vit. B12          #</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>linreg_beta_miscA <span class="ot">&lt;-</span> </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_drigf.sas7bdat'</span>))</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">!=</span><span class="st">"r2"</span>)</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a><span class="co">#        Dietary Folate Eq, Mg, K, Fibers        #</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>linreg_beta_miscB <span class="ot">&lt;-</span> </span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_drigf.sas7bdat'</span>))</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">!=</span><span class="st">"r2"</span>)</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a><span class="co">#                Vitamin A (RAE)                 #</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>linreg_beta_rae <span class="ot">&lt;-</span> </span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'lin_beta_drigf.sas7bdat'</span>))</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name<span class="sc">!=</span><span class="st">"r2"</span>)</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Append all nutrient, remove useless variables  #</span></span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>linreg_beta_all <span class="ot">&lt;-</span> </span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(linreg_beta_pro,linreg_beta_catvitd,</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>        linreg_beta_miscA,linreg_beta_miscB,</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>        linreg_beta_rae) <span class="sc">|&gt;</span> </span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(name,alpha,one_minus_half_alpha,</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>            t_quant,tvalue,pvalue,svalue,<span class="st">`</span><span class="at">_ci</span><span class="st">`</span>,<span class="st">`</span><span class="at">_se</span><span class="st">`</span>,</span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>            estimate_se)) </span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>   <span class="do">## add labels </span></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>    linreg_beta_all<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(linreg_beta_all<span class="sc">$</span>varname,</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> varname_list,</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> varlabel_list</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>    linreg_beta_all<span class="sc">$</span>drig_f <span class="ot">&lt;-</span> </span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(linreg_beta_all<span class="sc">$</span>drig,</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> drig_list,</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> drig_label</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"linreg_beta_pro"</span>,</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_beta_catvitd"</span>,</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_beta_miscA"</span>,</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_beta_miscB"</span>,</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>          <span class="st">"linreg_beta_rae"</span>))</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Make new estimate with proper rounding</span></span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>linreg_beta_all <span class="ot">&lt;-</span> </span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>  linreg_beta_all <span class="sc">|&gt;</span> </span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>estimate_ci) <span class="sc">|&gt;</span> </span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">rounding =</span> </span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>      <span class="fu">case_when</span> (</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a>       varname <span class="sc">==</span> <span class="st">'pro'</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'pro_kg'</span> <span class="sc">~</span> <span class="fl">0.01</span>,</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'calcium'</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'vit_d'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'iron'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'zinc'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'vit_b6'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'vit_b12'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'dfe'</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'mg'</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'pota'</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'fibers'</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>        varname <span class="sc">==</span> <span class="st">'rae'</span> <span class="sc">~</span> <span class="dv">1</span> ),</span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_ci =</span> <span class="fu">makeEstimateCI</span>(estimate,lcl95,ucl95,<span class="at">sep=</span><span class="st">", "</span>,<span class="at">rounding=</span>rounding)</span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a><span class="co">#      Rescale coef. as a function of mean       #</span></span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a><span class="co"># Import distribution data to obtain mean (usual) intake</span></span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: &lt;distrib_y&gt; data created in chunk &lt;distrib-y-data&gt;</span></span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a>linreg_beta_all_ratio <span class="ot">&lt;-</span> </span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>  distrib_y <span class="sc">|&gt;</span> </span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select relevant variables</span></span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(varname,drig,Mean) <span class="sc">|&gt;</span> </span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine with lin. reg. beta, keeping only rows in that data</span></span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">right_join</span>(linreg_beta_all) <span class="sc">|&gt;</span> </span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate diff. as a proportion of mean</span></span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio =</span> estimate<span class="sc">/</span>Mean</span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector of variable names according to ratio value</span></span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>y_sorted_beta_drig0 <span class="ot">&lt;-</span></span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a>  linreg_beta_all_ratio <span class="sc">|&gt;</span></span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(ratio)) <span class="sc">|&gt;</span></span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>   <span class="co"># remove units from varnames_f</span></span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(</span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> varname_f,</span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a>      <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"varname_f2"</span>,<span class="st">"unit"</span>),</span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">', '</span>,</span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a>      <span class="at">remove=</span><span class="cn">FALSE</span></span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname_f2 =</span> <span class="fu">lapply</span>(varname_f2,<span class="cf">function</span>(x) <span class="fu">str_replace</span>(x, <span class="st">"^</span><span class="sc">\\</span><span class="st">w{1}"</span>, tolower) )</span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a><span class="co">#             Save intermediate data             #</span></span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(linreg_beta_all,</span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"linreg_beta_all.rdata"</span>))</span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(y_sorted_beta_drig0,</span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"y_sorted_beta_drig0.rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Relationships between the HEFI-2019 score and nutrient intakes are illustrated in <strong><a href="#fig-linreg">Figure&nbsp;3</a></strong>. Respondents with higher HEFI-2019 score had higher intakes of fiber, magnesium, vitamin B6, potassium, and protein, but lower intakes of vitamin D, vitamin B12, folate, and iron. The associations between the HEFI-2019 score and intakes of vitamin A, calcium, and zinc were weak or null. <strong><a href="#tbl-linreg-beta">Table&nbsp;1</a></strong> presents the expected difference in nutrient intakes associated with an increase in HEFI-2019 score to the 90<sup>th</sup> percentile of the score distribution compared with median HEFI-2019 score. For example, increasing HEFI-2019 from the median to the 90<sup>th</sup> percentile of the score distribution was associated with a 3.4 g/day higher fiber intake (95%CI: 2.0, 4.8; <a href="#tbl-linreg-beta">Table&nbsp;1</a>. In contrast, the same HEFI-2019 score increase was associated with a 0.5 µ/day lower vitamin D intake (95%CI: -1.0, 0.0; <a href="#tbl-linreg-beta">Table&nbsp;1</a>).</p>
<div style="page-break-after: always;"></div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#              Linear regression with RCS - NUTRIENTS                     #</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load intermediate data - ensures this chunk works regardless of prior execution</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"mc_t_subset.rdata"</span>))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"linreg_plot_all.rdata"</span>))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"y_sorted_beta_drig0.rdata"</span>))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new data/new factor variable with ordered nutrients according to value of ratio</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>facet_nut_data <span class="ot">&lt;-</span> </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  linreg_plot_all <span class="sc">|&gt;</span> </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span>) </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>facet_nut_data<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(facet_nut_data<span class="sc">$</span>varname,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels =</span> y_sorted_beta_drig0<span class="sc">$</span>varname,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> y_sorted_beta_drig0<span class="sc">$</span>varname_f )</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>facet_nut_color <span class="ot">&lt;-</span> </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  MetBrewer<span class="sc">::</span><span class="fu">met.brewer</span>(<span class="st">"Johnson"</span>, </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n=</span><span class="fu">length</span>(<span class="fu">unique</span>(facet_nut_data<span class="sc">$</span>varname_f)), </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot (Nutrient | HEFI-2019) relationship ordered by % change in mean intake </span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>linreg_nut_all <span class="ot">&lt;-</span> </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  facet_nut_data <span class="sc">|&gt;</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>HEFI2019_TOTAL_SCORE,<span class="at">y=</span>estimate)) <span class="sc">+</span> </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>mc_t_subset,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span>HEFI2019_TOTAL_SCORE,<span class="at">y=</span>estimate),<span class="at">alpha=</span><span class="fl">0.3</span>,<span class="at">shape=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lcl95,<span class="at">ymax=</span>ucl95),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>varname_f), <span class="at">linewidth=</span><span class="fl">1.05</span>) <span class="sc">+</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>HEFI2019_TOTAL_SCORE,<span class="at">y=</span>lcl95,<span class="at">color=</span>varname_f),<span class="at">linetype=</span><span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>HEFI2019_TOTAL_SCORE,<span class="at">y=</span>ucl95,<span class="at">color=</span>varname_f),<span class="at">linetype=</span><span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>facet_nut_color) <span class="sc">+</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">80</span>, <span class="at">by=</span><span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>varname_f,<span class="at">scales=</span><span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"HEFI-2019 score based on usual intakes (/80), points"</span>,</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Usual nutrient intake"</span>) <span class="sc">+</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Show figure</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>linreg_nut_all</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="co">#            Export graph as PDF/PNG             #</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(ms_dir,<span class="st">'Fig3_reg_hefi_nut.pdf'</span>),</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot=</span>linreg_nut_all, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="fl">13.5</span>,<span class="at">height=</span><span class="fl">7.5</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="dv">1</span>,<span class="at">device =</span> cairo_pdf)</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(ms_dir,<span class="st">'Fig3_reg_hefi_nut.png'</span>),</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot=</span>linreg_nut_all, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="fl">13.5</span>,<span class="at">height=</span><span class="fl">7.5</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-linreg" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="9.1-HEFI19-NUT_ARTICLE_files/figure-html/fig-linreg-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Linear regression of nutrient intake on the total HEFI-2019 score in 4,089 adults aged 65 years or more from the CCHS 2015 - Nutrition. A positive relationship indicates that greater HEFI-2019 scores are associated with greater nutrient intake, and inversely. For visualization purpose, data points are from a random sample of 200 respondents selected proportionally to sampling weights. All dietary intakes were modelled using the National Cancer Institute multivariate method to estimate usual intakes (see Methods). 95%CI were estimated using 500 bootstrap weight replicates. CCHS, Canadian Community Health Survey; HEFI-2019, Healthy Eating Food Index-2019.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<div class="cell tbl-cap-location-top" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#           Generate table of regression coefficient estimates            #</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#        Calculate unweighted sample size        #</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>tbl_freq_drig <span class="ot">&lt;-</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(<span class="fu">subset</span>(hs_65y, energy<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">$</span>drig, <span class="at">dnn=</span><span class="st">"drig"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total    =</span> scales<span class="sc">::</span><span class="fu">number</span>(<span class="fu">sum</span>(Freq),<span class="at">big.mark=</span><span class="st">","</span>),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Freq_fmt =</span> scales<span class="sc">::</span><span class="fu">number</span>(Freq,<span class="at">big.mark=</span><span class="st">","</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                  Print table                   #</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co"># load </span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">file.path</span>(res_dir,<span class="st">"linreg_beta_all.rdata"</span>))</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>tbl_linreg_beta <span class="ot">&lt;-</span> </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  linreg_beta_all <span class="sc">|&gt;</span> </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create proper labels for DRI age/sex group using the unweighted sample sizes</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">drig_f_n =</span> </span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">case_when</span>(</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>        drig <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(drig_f, <span class="st">" (n="</span>, tbl_freq_drig[<span class="dv">1</span>,<span class="st">"Total"</span>],<span class="st">")"</span>),</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>        drig <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="fu">paste0</span>(drig_f, <span class="st">" (n="</span>, <span class="fu">subset</span>(tbl_freq_drig, drig<span class="sc">==</span><span class="dv">12</span>,<span class="st">"Freq_fmt"</span>),<span class="st">")"</span>),</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>        drig <span class="sc">==</span> <span class="dv">13</span> <span class="sc">~</span> <span class="fu">paste0</span>(drig_f, <span class="st">" (n="</span>, <span class="fu">subset</span>(tbl_freq_drig, drig<span class="sc">==</span><span class="dv">13</span>,<span class="st">"Freq_fmt"</span>),<span class="st">")"</span>),</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        drig <span class="sc">==</span> <span class="dv">14</span> <span class="sc">~</span> <span class="fu">paste0</span>(drig_f, <span class="st">" (n="</span>, <span class="fu">subset</span>(tbl_freq_drig, drig<span class="sc">==</span><span class="dv">14</span>,<span class="st">"Freq_fmt"</span>),<span class="st">")"</span>),</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        drig <span class="sc">==</span> <span class="dv">15</span> <span class="sc">~</span> <span class="fu">paste0</span>(drig_f, <span class="st">" (n="</span>, <span class="fu">subset</span>(tbl_freq_drig, drig<span class="sc">==</span><span class="dv">15</span>,<span class="st">"Freq_fmt"</span>),<span class="st">")"</span>),</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># transpose data from long to wide </span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(varname_f, drig_f_n, estimate_ci) <span class="sc">|&gt;</span> </span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from=</span><span class="st">"drig_f_n"</span>,</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values_from=</span> <span class="st">"estimate_ci"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate table with gt()</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_spanner</span>(<span class="at">label =</span> <span class="st">"Dietary Reference Intake group"</span>,</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>                  <span class="at">columns =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_label</span>(</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname_f =</span> <span class="st">"Nutrients"</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_style</span>(</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)  ),</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_spanners</span>(<span class="at">spanners=</span><span class="fu">everything</span>())</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_header</span>(<span class="at">title=</span> <span class="st">"Usual nutrient intake difference between HEFI-2019 scores at the 90th percentile and the median of the HEFI-2019 score distribution in 4,089 adults aged 65 years and older from the CCHS 2015 - Nutrition"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span>  <span class="st">"Values are expected nutrient intake differences (95%CI) for a HEFI-2019 score at the 90th compared with the 50th percentile of the score distribution and were estimated using linear regression models.Estimates reflect the expected nutrient intake difference when HEFI-2019 scores are increased to correspond to the 90th percentile of the score distribution, compared with the median HEFI-2019 score. All dietary intakes were modelled using the National Cancer Institute multivariate method to estimate usual intakes (see Methods). 95%CI were estimated using 500 bootstrap weight replicates. Sample size indicate the number of respondents without applying sampling weights, but other estimates were weighted to reflect the Canadian population. CCHS, Canadian Community Health Survey; d, day; HEFI-2019, Healthy Eating Food Index-2019."</span>,</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>(<span class="st">"title"</span>)</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gtstyle</span>()</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a><span class="co">#  Use &lt;gtsave_select&gt; function to print table directly or save as docx   #</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a><span class="fu">gtsave_select</span>(tbl_linreg_beta,<span class="fu">paste0</span>(<span class="st">"Table 1. linear reg estimate"</span>),<span class="at">docx=</span><span class="st">"N"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-linreg-beta" class="anchored">

<div id="kcazdcqpns" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kcazdcqpns table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kcazdcqpns thead, #kcazdcqpns tbody, #kcazdcqpns tfoot, #kcazdcqpns tr, #kcazdcqpns td, #kcazdcqpns th {
  border-style: none;
}

#kcazdcqpns p {
  margin: 0;
  padding: 0;
}

#kcazdcqpns .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kcazdcqpns .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kcazdcqpns .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kcazdcqpns .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kcazdcqpns .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kcazdcqpns .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kcazdcqpns .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kcazdcqpns .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kcazdcqpns .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kcazdcqpns .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kcazdcqpns .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kcazdcqpns .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kcazdcqpns .gt_spanner_row {
  border-bottom-style: hidden;
}

#kcazdcqpns .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kcazdcqpns .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kcazdcqpns .gt_from_md > :first-child {
  margin-top: 0;
}

#kcazdcqpns .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kcazdcqpns .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kcazdcqpns .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kcazdcqpns .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kcazdcqpns .gt_row_group_first td {
  border-top-width: 2px;
}

#kcazdcqpns .gt_row_group_first th {
  border-top-width: 2px;
}

#kcazdcqpns .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kcazdcqpns .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kcazdcqpns .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kcazdcqpns .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kcazdcqpns .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kcazdcqpns .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kcazdcqpns .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kcazdcqpns .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kcazdcqpns .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kcazdcqpns .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kcazdcqpns .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kcazdcqpns .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kcazdcqpns .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kcazdcqpns .gt_left {
  text-align: left;
}

#kcazdcqpns .gt_center {
  text-align: center;
}

#kcazdcqpns .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kcazdcqpns .gt_font_normal {
  font-weight: normal;
}

#kcazdcqpns .gt_font_bold {
  font-weight: bold;
}

#kcazdcqpns .gt_font_italic {
  font-style: italic;
}

#kcazdcqpns .gt_super {
  font-size: 65%;
}

#kcazdcqpns .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kcazdcqpns .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kcazdcqpns .gt_indent_1 {
  text-indent: 5px;
}

#kcazdcqpns .gt_indent_2 {
  text-indent: 10px;
}

#kcazdcqpns .gt_indent_3 {
  text-indent: 15px;
}

#kcazdcqpns .gt_indent_4 {
  text-indent: 20px;
}

#kcazdcqpns .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;1:  <p>tbl-linreg-beta</p> </caption>
  <thead>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Usual nutrient intake difference between HEFI-2019 scores at the 90th percentile and the median of the HEFI-2019 score distribution in 4,089 adults aged 65 years and older from the CCHS 2015 - Nutrition<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></td>
    </tr>
    
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="2" colspan="1" scope="col" id="Nutrients">Nutrients</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Adults 65 y+ (n=4,089)">Adults 65 y+ (n=4,089)</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="4" style="font-weight: bold;" scope="colgroup" id="Dietary Reference Intake group">
        <span class="gt_column_spanner">Dietary Reference Intake group</span>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Males, 65 to 70 y (n=567)">Males, 65 to 70 y (n=567)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Females, 65 to 70 y (n=720)">Females, 65 to 70 y (n=720)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Males, 71 y+ (n=1,246)">Males, 71 y+ (n=1,246)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Females, 71 y+ (n=1,556)">Females, 71 y+ (n=1,556)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="varname_f" class="gt_row gt_center">Protein, g/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">3 (-2, 8)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">2 (-4, 9)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">5 (-1, 11)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">2 (-4, 8)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">4 (-2, 10)</td></tr>
    <tr><td headers="varname_f" class="gt_row gt_center">Calcium, mg/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">4 (-50, 57)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">-16 (-96, 65)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">21 (-47, 89)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">-14 (-88, 60)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">25 (-38, 89)</td></tr>
    <tr><td headers="varname_f" class="gt_row gt_center">Vitamin D, mcg/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">-0.5 (-1.0, 0.0)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">-0.8 (-1.6, -0.1)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">-0.1 (-0.7, 0.5)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">-0.7 (-1.5, 0.0)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">-0.1 (-0.7, 0.6)</td></tr>
    <tr><td headers="varname_f" class="gt_row gt_center">Iron, mg/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">-0.2 (-1.0, 0.5)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">-0.6 (-1.8, 0.6)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">0.2 (-0.7, 1.1)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">-0.6 (-1.8, 0.6)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">0.3 (-0.5, 1.1)</td></tr>
    <tr><td headers="varname_f" class="gt_row gt_center">Vitamin B12, mcg/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">-0.3 (-0.7, 0.1)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">-0.4 (-0.9, 0.0)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">-0.1 (-0.7, 0.4)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">-0.4 (-0.8, 0.1)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">-0.1 (-0.6, 0.4)</td></tr>
    <tr><td headers="varname_f" class="gt_row gt_center">Vitamin B6, mg/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">0.1 (0.0, 0.2)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">0.1 (0.0, 0.2)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">0.1 (0.0, 0.3)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">0.1 (0.0, 0.2)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">0.1 (0.0, 0.2)</td></tr>
    <tr><td headers="varname_f" class="gt_row gt_center">Zinc, mg/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">0.0 (-0.7, 0.7)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">-0.4 (-1.5, 0.7)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">0.4 (-0.3, 1.2)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">-0.3 (-1.3, 0.6)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">0.5 (-0.2, 1.2)</td></tr>
    <tr><td headers="varname_f" class="gt_row gt_center">Folate, DFE/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">-13 (-39, 14)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">-15 (-56, 26)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">-6 (-36, 25)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">-16 (-55, 22)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">-2 (-31, 27)</td></tr>
    <tr><td headers="varname_f" class="gt_row gt_center">Fiber, g/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">3.4 (2.0, 4.8)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">4.5 (2.2, 6.8)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">3.0 (1.2, 4.8)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">4.3 (2.2, 6.4)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">3.0 (1.3, 4.7)</td></tr>
    <tr><td headers="varname_f" class="gt_row gt_center">Magnesium, mg/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">33 (14, 52)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">44 (14, 73)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">30 (6, 55)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">39 (13, 65)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">31 (9, 53)</td></tr>
    <tr><td headers="varname_f" class="gt_row gt_center">Potassium, mg/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">173 (17, 328)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">230 (6, 455)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">170 (-27, 368)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">214 (3, 424)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">178 (-7, 363)</td></tr>
    <tr><td headers="varname_f" class="gt_row gt_center">Vitamin A, RAE/d</td>
<td headers="Adults 65 y+ (n=4,089)" class="gt_row gt_right">16 (-37, 69)</td>
<td headers="Males, 65 to 70 y (n=567)" class="gt_row gt_right">9 (-54, 71)</td>
<td headers="Females, 65 to 70 y (n=720)" class="gt_row gt_right">26 (-54, 106)</td>
<td headers="Males, 71 y+ (n=1,246)" class="gt_row gt_right">10 (-48, 68)</td>
<td headers="Females, 71 y+ (n=1,556)" class="gt_row gt_right">26 (-42, 95)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Values are expected nutrient intake differences (95%CI) for a HEFI-2019 score at the 90th compared with the 50th percentile of the score distribution and were estimated using linear regression models.Estimates reflect the expected nutrient intake difference when HEFI-2019 scores are increased to correspond to the 90th percentile of the score distribution, compared with the median HEFI-2019 score. All dietary intakes were modelled using the National Cancer Institute multivariate method to estimate usual intakes (see Methods). 95%CI were estimated using 500 bootstrap weight replicates. Sample size indicate the number of respondents without applying sampling weights, but other estimates were weighted to reflect the Canadian population. CCHS, Canadian Community Health Survey; d, day; HEFI-2019, Healthy Eating Food Index-2019.</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="relationship-between-the-hefi-2019-score-and-nutrient-intake-inadequacy" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-the-hefi-2019-score-and-nutrient-intake-inadequacy">Relationship between the HEFI-2019 Score and Nutrient Intake Inadequacy</h2>
<section id="inadequate-nutrient-intakes" class="level3">
<h3 class="anchored" data-anchor-id="inadequate-nutrient-intakes">Inadequate Nutrient Intakes</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#        Output Pr(X&lt;EAR | HEFI=t1),Pr(X&lt;EAR | HEFI=t0) and diff.         #</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Protein                     #</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>logreg_beta_pro0 <span class="ot">&lt;-</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_hefi_y06_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">t1perc=</span><span class="dv">90</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">t0perc=</span><span class="dv">50</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_hefi_y06_raw0.sas7bdat'</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"pro"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"pro_kg"</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(t1perc,t0perc))</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>logreg_beta_pro <span class="ot">&lt;-</span> </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_pro'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_drigf.sas7bdat'</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"pro"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># keeping only Pr(X&lt;EAR)</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(outcome<span class="sc">==</span><span class="st">"binary_06"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"pro_kg"</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co">#             Calcium and Vitamin D              #</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Import base model with Pr(X&lt;EAR) at t1 and t0</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>cavitd0 <span class="ot">&lt;-</span> </span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_ca_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"calcium"</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_vitd_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_d"</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>)</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>cavitd_drig0 <span class="ot">&lt;-</span> </span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_ca_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"calcium"</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_vitd_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_d"</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>      ) ) <span class="sc">|&gt;</span> </span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(t0perc,t1perc))</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Append both</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>  logreg_beta_catvitd0 <span class="ot">&lt;-</span> </span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(cavitd0,cavitd_drig0)  </span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>  <span class="do">## clean </span></span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"cavitd0"</span>,<span class="st">"cavitd_drig0"</span>))</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Import risk ratio</span></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>logreg_beta_catvitd <span class="ot">&lt;-</span> </span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group </span></span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_ca_vit_d'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_drigf.sas7bdat'</span>))</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some formatting for consistency</span></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">outcome=</span>varname) <span class="sc">|&gt;</span> </span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_ca"</span> <span class="sc">~</span> <span class="st">"calcium"</span>,</span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_vitd"</span> <span class="sc">~</span> <span class="st">"vit_d"</span></span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a><span class="co">#         Iron, Zinc, Vit. B6, Vit. B12          #</span></span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Import base model with Pr(X&lt;EAR) at t1 and t0</span></span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>miscA0 <span class="ot">&lt;-</span> </span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_iron_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"iron"</span></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_zinc_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"zinc"</span></span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_b6_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_b6"</span></span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_b12_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_b12"</span></span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>)</span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>miscA_drig0 <span class="ot">&lt;-</span> </span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_iron_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"iron"</span></span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_zinc_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"zinc"</span></span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_b6_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_b6"</span></span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_b12_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"vit_b12"</span></span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(t0perc,t1perc))</span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Append both</span></span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a>  logreg_beta_miscA0 <span class="ot">&lt;-</span> </span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(miscA0,miscA_drig0)  </span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a>  <span class="do">## clean </span></span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"miscA0"</span>,<span class="st">"miscA_drig0"</span>))</span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Import risk ratio</span></span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a>logreg_beta_miscA <span class="ot">&lt;-</span> </span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscA'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_drigf.sas7bdat'</span>))</span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span> </span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some formatting for consistency</span></span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">outcome=</span>varname) <span class="sc">|&gt;</span> </span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_iron"</span> <span class="sc">~</span> <span class="st">"iron"</span>,</span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_zinc"</span> <span class="sc">~</span> <span class="st">"zinc"</span>,</span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_b6"</span> <span class="sc">~</span> <span class="st">"vit_b6"</span>,</span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_b12"</span> <span class="sc">~</span> <span class="st">"vit_b12"</span></span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-163"><a href="#cb15-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-164"><a href="#cb15-164" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-165"><a href="#cb15-165" aria-hidden="true" tabindex="-1"></a><span class="co">#        Dietary Folate Eq, Mg, K, Fibers        #</span></span>
<span id="cb15-166"><a href="#cb15-166" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-167"><a href="#cb15-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-168"><a href="#cb15-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Import base model with Pr(X&lt;EAR) at t1 and t0</span></span>
<span id="cb15-169"><a href="#cb15-169" aria-hidden="true" tabindex="-1"></a>miscB0 <span class="ot">&lt;-</span> </span>
<span id="cb15-170"><a href="#cb15-170" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_dfe_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-171"><a href="#cb15-171" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-172"><a href="#cb15-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"dfe"</span></span>
<span id="cb15-173"><a href="#cb15-173" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-174"><a href="#cb15-174" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_mg_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-175"><a href="#cb15-175" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-176"><a href="#cb15-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"mg"</span></span>
<span id="cb15-177"><a href="#cb15-177" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-178"><a href="#cb15-178" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_pota_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-179"><a href="#cb15-179" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-180"><a href="#cb15-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"pota"</span></span>
<span id="cb15-181"><a href="#cb15-181" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-182"><a href="#cb15-182" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_fib_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-183"><a href="#cb15-183" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-184"><a href="#cb15-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"fibers"</span></span>
<span id="cb15-185"><a href="#cb15-185" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-186"><a href="#cb15-186" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>)</span>
<span id="cb15-187"><a href="#cb15-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-188"><a href="#cb15-188" aria-hidden="true" tabindex="-1"></a>miscB_drig0 <span class="ot">&lt;-</span> </span>
<span id="cb15-189"><a href="#cb15-189" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_dfe_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-190"><a href="#cb15-190" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-191"><a href="#cb15-191" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"dfe"</span></span>
<span id="cb15-192"><a href="#cb15-192" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-193"><a href="#cb15-193" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_mg_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-194"><a href="#cb15-194" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-195"><a href="#cb15-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"mg"</span></span>
<span id="cb15-196"><a href="#cb15-196" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-197"><a href="#cb15-197" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_pota_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-198"><a href="#cb15-198" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-199"><a href="#cb15-199" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"pota"</span></span>
<span id="cb15-200"><a href="#cb15-200" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-201"><a href="#cb15-201" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_fib_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-202"><a href="#cb15-202" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-203"><a href="#cb15-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"fibers"</span></span>
<span id="cb15-204"><a href="#cb15-204" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb15-205"><a href="#cb15-205" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(t0perc,t1perc))</span>
<span id="cb15-206"><a href="#cb15-206" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-207"><a href="#cb15-207" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Append both</span></span>
<span id="cb15-208"><a href="#cb15-208" aria-hidden="true" tabindex="-1"></a>  logreg_beta_miscB0 <span class="ot">&lt;-</span> </span>
<span id="cb15-209"><a href="#cb15-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(miscB0,miscB_drig0)  </span>
<span id="cb15-210"><a href="#cb15-210" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-211"><a href="#cb15-211" aria-hidden="true" tabindex="-1"></a>  <span class="do">## clean </span></span>
<span id="cb15-212"><a href="#cb15-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"miscB0"</span>,<span class="st">"miscB_drig0"</span>))</span>
<span id="cb15-213"><a href="#cb15-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-214"><a href="#cb15-214" aria-hidden="true" tabindex="-1"></a><span class="co"># Import risk ratio</span></span>
<span id="cb15-215"><a href="#cb15-215" aria-hidden="true" tabindex="-1"></a>logreg_beta_miscB <span class="ot">&lt;-</span> </span>
<span id="cb15-216"><a href="#cb15-216" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-217"><a href="#cb15-217" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb15-218"><a href="#cb15-218" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb15-219"><a href="#cb15-219" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb15-220"><a href="#cb15-220" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb15-221"><a href="#cb15-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb15-222"><a href="#cb15-222" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_miscB'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_drigf.sas7bdat'</span>))</span>
<span id="cb15-223"><a href="#cb15-223" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb15-224"><a href="#cb15-224" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig)  <span class="sc">|&gt;</span> </span>
<span id="cb15-225"><a href="#cb15-225" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some formatting for consistency</span></span>
<span id="cb15-226"><a href="#cb15-226" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">outcome=</span>varname) <span class="sc">|&gt;</span> </span>
<span id="cb15-227"><a href="#cb15-227" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-228"><a href="#cb15-228" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-229"><a href="#cb15-229" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_dfe"</span> <span class="sc">~</span> <span class="st">"dfe"</span>,</span>
<span id="cb15-230"><a href="#cb15-230" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_fib"</span> <span class="sc">~</span> <span class="st">"fibers"</span>,</span>
<span id="cb15-231"><a href="#cb15-231" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_pota"</span> <span class="sc">~</span> <span class="st">"pota"</span>,</span>
<span id="cb15-232"><a href="#cb15-232" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_mg"</span> <span class="sc">~</span> <span class="st">"mg"</span></span>
<span id="cb15-233"><a href="#cb15-233" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-234"><a href="#cb15-234" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-235"><a href="#cb15-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-236"><a href="#cb15-236" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-237"><a href="#cb15-237" aria-hidden="true" tabindex="-1"></a><span class="co">#                Vitamin A (RAE)                 #</span></span>
<span id="cb15-238"><a href="#cb15-238" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-239"><a href="#cb15-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-240"><a href="#cb15-240" aria-hidden="true" tabindex="-1"></a><span class="co"># Import base model with Pr(X&lt;EAR) at t1 and t0</span></span>
<span id="cb15-241"><a href="#cb15-241" aria-hidden="true" tabindex="-1"></a>logreg_beta_rae0 <span class="ot">&lt;-</span> </span>
<span id="cb15-242"><a href="#cb15-242" aria-hidden="true" tabindex="-1"></a>  (haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Reg'</span>, <span class="st">'logr_mod_y_rae_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-243"><a href="#cb15-243" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>) </span>
<span id="cb15-244"><a href="#cb15-244" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">|&gt;</span> </span>
<span id="cb15-245"><a href="#cb15-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb15-246"><a href="#cb15-246" aria-hidden="true" tabindex="-1"></a>    haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Reg_drig'</span>, <span class="st">'logr_mod_y_rae_raw0.sas7bdat'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-247"><a href="#cb15-247" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(t1perc,t0perc)) </span>
<span id="cb15-248"><a href="#cb15-248" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-249"><a href="#cb15-249" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"rae"</span>)</span>
<span id="cb15-250"><a href="#cb15-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-251"><a href="#cb15-251" aria-hidden="true" tabindex="-1"></a><span class="co"># Import risk ratio</span></span>
<span id="cb15-252"><a href="#cb15-252" aria-hidden="true" tabindex="-1"></a>logreg_beta_rae <span class="ot">&lt;-</span> </span>
<span id="cb15-253"><a href="#cb15-253" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_allf.sas7bdat'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-254"><a href="#cb15-254" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb15-255"><a href="#cb15-255" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span></span>
<span id="cb15-256"><a href="#cb15-256" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb15-257"><a href="#cb15-257" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb15-258"><a href="#cb15-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>( haven<span class="sc">::</span><span class="fu">read_sas</span>(</span>
<span id="cb15-259"><a href="#cb15-259" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(path,<span class="st">'NCI'</span>, <span class="st">'MCMC_vit_a'</span>, <span class="st">'Results'</span>, <span class="st">'log_beta_drigf.sas7bdat'</span>))</span>
<span id="cb15-260"><a href="#cb15-260" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb15-261"><a href="#cb15-261" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig)  <span class="sc">|&gt;</span> </span>
<span id="cb15-262"><a href="#cb15-262" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some formatting for consistency</span></span>
<span id="cb15-263"><a href="#cb15-263" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">outcome=</span>varname) <span class="sc">|&gt;</span> </span>
<span id="cb15-264"><a href="#cb15-264" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-265"><a href="#cb15-265" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-266"><a href="#cb15-266" aria-hidden="true" tabindex="-1"></a>      outcome <span class="sc">==</span><span class="st">"binary_rae"</span> <span class="sc">~</span> <span class="st">"rae"</span></span>
<span id="cb15-267"><a href="#cb15-267" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-268"><a href="#cb15-268" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-269"><a href="#cb15-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-270"><a href="#cb15-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-271"><a href="#cb15-271" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-272"><a href="#cb15-272" aria-hidden="true" tabindex="-1"></a><span class="co"># Append all nutrient, remove useless variables  #</span></span>
<span id="cb15-273"><a href="#cb15-273" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-274"><a href="#cb15-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-275"><a href="#cb15-275" aria-hidden="true" tabindex="-1"></a><span class="co"># Pr(X&lt;EAR) at t1 and t0</span></span>
<span id="cb15-276"><a href="#cb15-276" aria-hidden="true" tabindex="-1"></a>logreg_beta_all0 <span class="ot">&lt;-</span> </span>
<span id="cb15-277"><a href="#cb15-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(logreg_beta_pro0,logreg_beta_catvitd0,</span>
<span id="cb15-278"><a href="#cb15-278" aria-hidden="true" tabindex="-1"></a>        logreg_beta_miscA0,logreg_beta_miscB0,</span>
<span id="cb15-279"><a href="#cb15-279" aria-hidden="true" tabindex="-1"></a>        logreg_beta_rae0) <span class="sc">|&gt;</span> </span>
<span id="cb15-280"><a href="#cb15-280" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(replicate,z,log_beta0)) <span class="sc">|&gt;</span> </span>
<span id="cb15-281"><a href="#cb15-281" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate t1 vs t0 difference to assess consistency</span></span>
<span id="cb15-282"><a href="#cb15-282" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-283"><a href="#cb15-283" aria-hidden="true" tabindex="-1"></a>    <span class="at">t1t0_diff =</span> t1<span class="sc">-</span>t0</span>
<span id="cb15-284"><a href="#cb15-284" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-285"><a href="#cb15-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-286"><a href="#cb15-286" aria-hidden="true" tabindex="-1"></a>   <span class="do">## add labels </span></span>
<span id="cb15-287"><a href="#cb15-287" aria-hidden="true" tabindex="-1"></a>    logreg_beta_all0<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb15-288"><a href="#cb15-288" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(logreg_beta_all0<span class="sc">$</span>varname,</span>
<span id="cb15-289"><a href="#cb15-289" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> varname_list,</span>
<span id="cb15-290"><a href="#cb15-290" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> varlabeltidy_list</span>
<span id="cb15-291"><a href="#cb15-291" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb15-292"><a href="#cb15-292" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-293"><a href="#cb15-293" aria-hidden="true" tabindex="-1"></a>    logreg_beta_all0<span class="sc">$</span>drig_f <span class="ot">&lt;-</span> </span>
<span id="cb15-294"><a href="#cb15-294" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(logreg_beta_all0<span class="sc">$</span>drig,</span>
<span id="cb15-295"><a href="#cb15-295" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> drig_list,</span>
<span id="cb15-296"><a href="#cb15-296" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> drig_label</span>
<span id="cb15-297"><a href="#cb15-297" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb15-298"><a href="#cb15-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-299"><a href="#cb15-299" aria-hidden="true" tabindex="-1"></a><span class="co"># Risk ratio estimate</span></span>
<span id="cb15-300"><a href="#cb15-300" aria-hidden="true" tabindex="-1"></a>logreg_beta_all <span class="ot">&lt;-</span> </span>
<span id="cb15-301"><a href="#cb15-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(logreg_beta_pro,logreg_beta_catvitd,</span>
<span id="cb15-302"><a href="#cb15-302" aria-hidden="true" tabindex="-1"></a>        logreg_beta_miscA,logreg_beta_miscB,</span>
<span id="cb15-303"><a href="#cb15-303" aria-hidden="true" tabindex="-1"></a>        logreg_beta_rae) <span class="sc">|&gt;</span> </span>
<span id="cb15-304"><a href="#cb15-304" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(label,alpha,one_minus_half_alpha,</span>
<span id="cb15-305"><a href="#cb15-305" aria-hidden="true" tabindex="-1"></a>            t_quant,tvalue,pvalue,svalue,<span class="st">`</span><span class="at">_ci</span><span class="st">`</span>,<span class="st">`</span><span class="at">_se</span><span class="st">`</span>,</span>
<span id="cb15-306"><a href="#cb15-306" aria-hidden="true" tabindex="-1"></a>            estimate_se,estimate_ci)) <span class="sc">|&gt;</span></span>
<span id="cb15-307"><a href="#cb15-307" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove fibers and potassium (AI) which cannot be shown in this figure</span></span>
<span id="cb15-308"><a href="#cb15-308" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb15-309"><a href="#cb15-309" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>(varname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fibers"</span>,<span class="st">"pota"</span>))</span>
<span id="cb15-310"><a href="#cb15-310" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-311"><a href="#cb15-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-312"><a href="#cb15-312" aria-hidden="true" tabindex="-1"></a>   <span class="do">## add labels </span></span>
<span id="cb15-313"><a href="#cb15-313" aria-hidden="true" tabindex="-1"></a>    logreg_beta_all<span class="sc">$</span>varname_f <span class="ot">&lt;-</span> </span>
<span id="cb15-314"><a href="#cb15-314" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(logreg_beta_all<span class="sc">$</span>varname,</span>
<span id="cb15-315"><a href="#cb15-315" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> varname_list,</span>
<span id="cb15-316"><a href="#cb15-316" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> varlabeltidy_list</span>
<span id="cb15-317"><a href="#cb15-317" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb15-318"><a href="#cb15-318" aria-hidden="true" tabindex="-1"></a>    logreg_beta_all<span class="sc">$</span>drig_f <span class="ot">&lt;-</span> </span>
<span id="cb15-319"><a href="#cb15-319" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(logreg_beta_all<span class="sc">$</span>drig,</span>
<span id="cb15-320"><a href="#cb15-320" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> drig_list,</span>
<span id="cb15-321"><a href="#cb15-321" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels =</span> drig_label</span>
<span id="cb15-322"><a href="#cb15-322" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb15-323"><a href="#cb15-323" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-324"><a href="#cb15-324" aria-hidden="true" tabindex="-1"></a><span class="do">## clean temporary</span></span>
<span id="cb15-325"><a href="#cb15-325" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"logreg_beta_pro"</span>,</span>
<span id="cb15-326"><a href="#cb15-326" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_catvitd"</span>,</span>
<span id="cb15-327"><a href="#cb15-327" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_miscA"</span>,</span>
<span id="cb15-328"><a href="#cb15-328" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_miscB"</span>,</span>
<span id="cb15-329"><a href="#cb15-329" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_rae"</span>,</span>
<span id="cb15-330"><a href="#cb15-330" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_pro0"</span>,</span>
<span id="cb15-331"><a href="#cb15-331" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_catvitd0"</span>,</span>
<span id="cb15-332"><a href="#cb15-332" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_miscA0"</span>,</span>
<span id="cb15-333"><a href="#cb15-333" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_miscB0"</span>,</span>
<span id="cb15-334"><a href="#cb15-334" aria-hidden="true" tabindex="-1"></a>          <span class="st">"logreg_beta_rae0"</span>))</span>
<span id="cb15-335"><a href="#cb15-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-336"><a href="#cb15-336" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare ordered, formatted data for in text citation purpose</span></span>
<span id="cb15-337"><a href="#cb15-337" aria-hidden="true" tabindex="-1"></a>logreg_beta_drig0_ordered <span class="ot">&lt;-</span> </span>
<span id="cb15-338"><a href="#cb15-338" aria-hidden="true" tabindex="-1"></a>  logreg_beta_all <span class="sc">|&gt;</span></span>
<span id="cb15-339"><a href="#cb15-339" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span>,name<span class="sc">==</span><span class="st">"risk_diff"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-340"><a href="#cb15-340" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(estimate) <span class="sc">|&gt;</span></span>
<span id="cb15-341"><a href="#cb15-341" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-342"><a href="#cb15-342" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname_f2 =</span> <span class="fu">lapply</span>(varname_f,<span class="cf">function</span>(x) <span class="fu">str_replace</span>(x, <span class="st">"^</span><span class="sc">\\</span><span class="st">w{1}"</span>, tolower) )</span>
<span id="cb15-343"><a href="#cb15-343" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-344"><a href="#cb15-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-345"><a href="#cb15-345" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-346"><a href="#cb15-346" aria-hidden="true" tabindex="-1"></a><span class="co">#  Save data to re-use in Supplemental Material  #</span></span>
<span id="cb15-347"><a href="#cb15-347" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb15-348"><a href="#cb15-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-349"><a href="#cb15-349" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(logreg_beta_all0,</span>
<span id="cb15-350"><a href="#cb15-350" aria-hidden="true" tabindex="-1"></a>     <span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"logreg_beta_all0.rdata"</span>))</span>
<span id="cb15-351"><a href="#cb15-351" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(logreg_beta_all,</span>
<span id="cb15-352"><a href="#cb15-352" aria-hidden="true" tabindex="-1"></a>     <span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"logreg_beta_all.rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="#fig-logreg">Figure&nbsp;4</a> presents the prevalence and the difference in the prevalence of inadequate nutrient intake according to the HEFI-2019 score. An increase of HEFI-2019 score to the 90<sup>th</sup> percentile of the score distribution compared with median HEFI-2019 score was associated with reduction of 19.8, 12.7, and 4.7 percentage points in the prevalence of inadequate nutrient intakes for magnesium, vitamin B6, and protein, respectively. Inversely, the same HEFI-2019 score increase was associated with a minor increase in the prevalence of inadequate vitamin D intakes (prevalence difference, +2.6%; 95%CI: 1.1, 4.0%). The prevalence of inadequate iron intake was 0% and thus unaffected by hypothetical HEFI-2019 score change. For vitamin A, zinc, vitamin B12, calcium and folate, the 95%CI were wide and compatible with both increase and decrease in the prevalence of inadequate intakes (<a href="#fig-logreg">Figure&nbsp;4</a>).</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#    Cleveland dot plot with Pr(X&lt;EAR) at t1, t0 and t1/t0 risk diff.     #</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note1: data for this plot was made in chunk above</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note2: to facilitate interpretations, nutrient are ordered by descending difference</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note3: due to very low Pr(X&lt;EAR) in some cases, absolute difference better reflect change than ratios</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"logreg_beta_all0.rdata"</span>))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"logreg_beta_all.rdata"</span>))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># remove &lt;/d&gt; in varname labels</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>logreg_beta_all0 <span class="ot">&lt;-</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  logreg_beta_all0 <span class="sc">|&gt;</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname_f =</span> <span class="fu">gsub</span>(<span class="st">"/d"</span>,<span class="st">""</span>,varname_f)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove fibers and potassium (AI) which cannot be shown in this figure</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>(varname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fibers"</span>,<span class="st">"pota"</span>))</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co">#         Panel A - Pr(X&lt;EAR) at t1, t0          #</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: both prevalence must be in the `wide` format to be plotted on the same line</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>panelA <span class="ot">&lt;-</span> </span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  logreg_beta_all0 <span class="sc">|&gt;</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> y0, <span class="at">y =</span> <span class="fu">reorder</span>(varname_f,<span class="fu">desc</span>(risk_diff),<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="at">shape=</span><span class="st">"50th perc."</span>),<span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> y1, <span class="at">y =</span> <span class="fu">reorder</span>(varname_f,<span class="fu">desc</span>(risk_diff),<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="at">shape=</span><span class="st">"90th perc."</span>),<span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="cn">NULL</span>,</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Prevalence of</span><span class="sc">\n</span><span class="st">inadequate intakes, %"</span>,<span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dotplotx</span>()<span class="sc">+</span> </span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"top"</span>) </span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="co">#           Panel B - t1/t0 risk ratio           #</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>panelB <span class="ot">&lt;-</span> </span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>  logreg_beta_all <span class="sc">|&gt;</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span>,name<span class="sc">==</span><span class="st">"risk_diff"</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create labels with estimates and 95ci</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_ci =</span> <span class="fu">makeEstimateCI</span>(estimate,lcl95,ucl95,<span class="at">sep=</span><span class="st">", "</span>,<span class="at">rounding=</span><span class="fl">0.1</span>)</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># graph</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(varname_f,<span class="fu">desc</span>(estimate),<span class="at">na.rm=</span><span class="cn">TRUE</span>))) <span class="sc">+</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">15</span>,<span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">color=</span><span class="st">"GRAY"</span>) <span class="sc">+</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>lcl95, <span class="at">xmax=</span>ucl95), <span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span>estimate, <span class="at">label=</span>estimate_ci, <span class="at">fontface=</span> <span class="st">"bold"</span>),</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">color=</span><span class="st">"BLACK"</span>, <span class="at">vjust =</span> <span class="dv">2</span> ,<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="cn">NULL</span>,<span class="at">x=</span><span class="st">"Prevalence difference,</span><span class="sc">\n</span><span class="st">% point (95%CI)"</span>) <span class="sc">+</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dotplotx</span>() <span class="sc">+</span> </span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"BLACK"</span>))</span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a><span class="co">#               Combine Panel A, B               #</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>  <span class="co">#note: combination performed with 'patchwork' package</span></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>logregplot <span class="ot">&lt;-</span> </span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>  panelA <span class="sc">+</span> panelB </span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>logregplot</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a><span class="co">#            Export graph as PDF/PNG             #</span></span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(ms_dir,<span class="st">'Fig4_hypothetical_inrease.pdf'</span>),</span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot=</span>logregplot, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">10</span>,<span class="at">height=</span><span class="dv">7</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="fl">0.8</span>,<span class="at">device =</span> cairo_pdf)</span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(ms_dir,<span class="st">'Fig4_hypothetical_inrease.png'</span>),</span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot=</span>logregplot, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">10</span>,<span class="at">height=</span><span class="dv">7</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-logreg" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="9.1-HEFI19-NUT_ARTICLE_files/figure-html/fig-logreg-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: Prevalence of inadequate intakes and difference for HEFI-2019 scores at the 90th compared with the 50th percentile of the score distribution in 4,089 adults aged 65 years or more from the CCHS 2015 - Nutrition. Inadequate intakes are intakes below the age- and sex-specific Estimated Average Requirements (EAR). Potassium and fiber are not shown, because only Adequate Intakes (AI) values are available for these nutrients. All dietary intakes were modelled using the National Cancer Institute multivariate method to estimate usual intakes (see Methods). 95%CI were estimated using 500 bootstrap weight replicates. CCHS, Canadian Community Health Survey; HEFI-2019, Healthy Eating Food Index-2019.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="hypothetical-higher-estimated-average-requirements-for-protein" class="level4">
<h4 class="anchored" data-anchor-id="hypothetical-higher-estimated-average-requirements-for-protein">Hypothetical higher Estimated Average Requirements for protein</h4>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: intakes above current recommendations may be relevant. Output these values</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     Look at what 1xStDev was in CCHS-2015      #</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#haven::read_sas(file.path(path,'NCI', 'MCMC_pro', 'Results', 'distrib_y_rel_w0.sas7bdat')) |&gt;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::select(replicate,drig,varname,Mean,StdDev,Variance,Max,Min,Pctile50)</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#note: StdDev ~ 0.24 g/kg for all respondents. Results not further use.</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#        Output Pr(X&lt;EAR | HEFI=t1),Pr(X&lt;EAR | HEFI=t0) and diff.         #</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>logreg_beta_pro0 <span class="ot">&lt;-</span> </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="co"># include current EAR for comparison purpose</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">"NCI"</span>,<span class="st">"MCMC_pro"</span>,<span class="st">"Reg"</span>,<span class="st">"logr_mod_hefi_y06_raw0.sas7bdat"</span>)),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 0.8g/kg/d (ie, potential EAR for recommendations at 1.0g/kg/d)</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">"NCI"</span>,<span class="st">"MCMC_pro"</span>,<span class="st">"Reg"</span>,<span class="st">"logr_mod_hefi_y08_raw0.sas7bdat"</span>)),</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1.0g/kg/d (ie, potential EAR for recommendations at 1.1 or 1.2g/kg/d)</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">"NCI"</span>,<span class="st">"MCMC_pro"</span>,<span class="st">"Reg"</span>,<span class="st">"logr_mod_hefi_y10_raw0.sas7bdat"</span>))</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, drig identifier</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">t1perc=</span><span class="dv">90</span>,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">t0perc=</span><span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">"NCI"</span>,<span class="st">"MCMC_pro"</span>,<span class="st">"Reg_drig"</span>,<span class="st">"logr_mod_hefi_y06_raw0.sas7bdat"</span>)),</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>        haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">"NCI"</span>,<span class="st">"MCMC_pro"</span>,<span class="st">"Reg_drig"</span>,<span class="st">"logr_mod_hefi_y08_raw0.sas7bdat"</span>)),</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>        haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">"NCI"</span>,<span class="st">"MCMC_pro"</span>,<span class="st">"Reg_drig"</span>,<span class="st">"logr_mod_hefi_y10_raw0.sas7bdat"</span>))</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">varname =</span> <span class="st">"pro_kg"</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(t1perc,t0perc,replicate,z)) <span class="sc">|&gt;</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(<span class="at">col=</span><span class="st">"label"</span>, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"outcome"</span>,<span class="st">"label"</span>),<span class="at">sep=</span><span class="st">"[|]"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Restrict to overall group for simplicity</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>     <span class="co"># multiply * 100 for simplicity</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#across(c("risk_diff","y0","y1"), function(x) x*100),</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">risk_diff =</span> risk_diff <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>logreg_beta_pro <span class="ot">&lt;-</span> </span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">paste0</span>(path,<span class="st">"/NCI/MCMC_pro/Results/log_beta_allf.sas7bdat"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add nutrient, DRIg identifier</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">drig=</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add DRI group here</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">"NCI"</span>,<span class="st">"MCMC_pro"</span>,<span class="st">"Results"</span>,<span class="st">"log_beta_drigf.sas7bdat"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">varname=</span><span class="st">"pro_kg"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(drig) <span class="sc">|&gt;</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># keeping only Pr(X&lt;EAR)</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(outcome <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"binary_06"</span>,<span class="st">"binary_08"</span>,<span class="st">"binary_10"</span>))  <span class="sc">|&gt;</span> </span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(label,alpha,one_minus_half_alpha,</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>            t_quant,tvalue,pvalue,svalue,<span class="st">`</span><span class="at">_ci</span><span class="st">`</span>,<span class="st">`</span><span class="at">_se</span><span class="st">`</span>,</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>            estimate_se,estimate_ci)) <span class="sc">|&gt;</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Restrict to overall group for simplicity</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(drig<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> name<span class="sc">==</span><span class="st">"risk_diff"</span>)</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a><span class="co">#  Save data to re-use in Supplemental Material  #</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a> <span class="fu">save</span>(logreg_beta_pro0, <span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"logreg_beta_pro0.rdata"</span>))</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a> <span class="fu">save</span>(logreg_beta_pro, <span class="at">file=</span><span class="fu">file.path</span>(res_dir,<span class="st">"logreg_beta_pro.rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Compared with the median HEFI-2019 score, scores at the 90<sup>th</sup> percentile decreased the proportion of respondents with protein intakes below hypothetical EAR of 0.8 g/kg/day and 1.0 g/kg/day (<strong>Supplemental Figure 2</strong>). For 0.8 g/kg/d, the prevalence of inadequacy decreased from 29.3% to 18.5% (prevalence difference: -10.8; 95%CI: -20.0, -1.6). For 1.0 g/kg/d, the prevalence decreased from 64.7% to 50.8% (prevalence difference: -13.9; 95%CI: -25.0, -2.8).</p>
</section>
</section>
</section>
<section id="adequate-intakes-for-fiber-and-potassium" class="level2">
<h2 class="anchored" data-anchor-id="adequate-intakes-for-fiber-and-potassium">Adequate Intakes for Fiber and Potassium</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#       Output Pr(X&gt;=AI | HEFI=t1),Pr(X&gt;=AI | HEFI=t0) and diff.          #</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#note: AI stands for "Adequate Intake"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>logreg_data_AI <span class="ot">&lt;-</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(<span class="fu">file.path</span>(path,<span class="st">"NCI"</span>,<span class="st">"MCMC_miscB"</span>,<span class="st">"Reg"</span>,<span class="st">"Bootstraps"</span>,<span class="st">"_logr_mod_hefi_y_rawbs.sas7bdat"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove invalid replicate + keep potassium, fibers</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(replicate<span class="sc">!=</span><span class="dv">484</span> <span class="sc">&amp;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                  (varname <span class="sc">==</span><span class="st">"binary_pota"</span> <span class="sc">|</span> varname <span class="sc">==</span><span class="st">"binary_fib"</span>) ) <span class="sc">|&gt;</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># keep only essential variables for clarity</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(replicate, varname, exp_y0, exp_y1) <span class="sc">|&gt;</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># inverse odds ratio to get Pr(X&gt;=x)</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp_y0_inverse =</span> <span class="dv">1</span><span class="sc">/</span>exp_y0,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp_y1_inverse =</span> <span class="dv">1</span><span class="sc">/</span>exp_y1,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate risk (exp/(1+exp))</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y0 =</span> exp_y0_inverse <span class="sc">/</span> (<span class="dv">1</span><span class="sc">+</span>exp_y0_inverse), </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> exp_y1_inverse <span class="sc">/</span> (<span class="dv">1</span><span class="sc">+</span>exp_y1_inverse),</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate risk difference, ratio</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">risk_diff =</span> y1 <span class="sc">-</span> y0 ,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">risk_ratio =</span> y1 <span class="sc">/</span> y0 </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co"># split original vs. replicate </span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>logreg0 <span class="ot">&lt;-</span> logreg_data_AI[logreg_data_AI<span class="sc">$</span>replicate<span class="sc">==</span><span class="dv">0</span>,]</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>logregbs <span class="ot">&lt;-</span> logreg_data_AI[logreg_data_AI<span class="sc">$</span>replicate<span class="sc">&gt;</span><span class="dv">0</span>,]</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate Standard Error for risk ratio (note: done manually to be consistent with SAS)</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>logregAI<span class="ot">&lt;-</span> </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  logregbs <span class="sc">|&gt;</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(varname) <span class="sc">|&gt;</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(risk_diff)</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(logreg0) <span class="sc">|&gt;</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># define normal quantile</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">qnorm =</span> <span class="fl">1.96</span>,</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate 95%ci</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">lcl95 =</span> risk_diff <span class="sc">-</span> se<span class="sc">*</span><span class="fl">1.96</span> ,</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">ucl95 =</span> risk_diff <span class="sc">+</span> se<span class="sc">*</span><span class="fl">1.96</span> ,</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># multiply * 100 for simplicity</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"y0"</span>,<span class="st">"y1"</span>,<span class="st">"risk_diff"</span>,<span class="st">"lcl95"</span>,<span class="st">"ucl95"</span>), <span class="cf">function</span>(x) x<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make formatted estimate, if need be</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_ci =</span> <span class="fu">makeEstimateCI</span>(risk_diff,lcl95,ucl95,<span class="at">sep=</span><span class="st">", "</span>,<span class="at">rounding=</span><span class="fl">0.1</span>)</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a><span class="co">#clean temporary</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">"logreg_data_AI"</span>,<span class="st">"logreg0"</span>,<span class="st">"logregbs"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Compared with the median HEFI-2019 score, score at the 90<sup>th</sup> percentile increased the proportion of respondents with intakes above the adequate intake for both fibers and potassium. For fibers, the prevalence increased from 6.5% to 20.5% (prevalence difference: +14.1; 95%CI: 5.1, 23.0). For potassium, the prevalence increased from 25.1% to 36.8% (prevalence difference: +11.7; 95%CI: 2.2, 21.1).</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>The objective of this study was to describe the relationship between adherence to CFG-2019 recommendations on healthy food choices, measured using the HEFI-2019, and nutrient intakes from food sources in adults 65 years and older from Canada in 2015. We found that higher adherence was associated with higher intakes of fiber, magnesium, vitamin B6, potassium and protein. Had respondents had a higher adherence, we estimated that the prevalence of nutrient inadequacy from foods and beverages for magnesium, vitamin B6 and protein would have been 20, 13, and 5 lower, respectively. However, a higher adherence was not associated with higher intakes of calcium, zinc, iron, folate, vitamin B12 and vitamin D. In turn, we estimated that the high prevalence of calcium inadequacy would not have changed and that of food-based vitamin D would have been 3% higher in 2015. Overall, these results indicate that CFG-2019 recommendations are insufficient to mitigate nutrient intake inadequacy for certain key nutrients based on the eating patterns of adults aged 65 years or more from Canada in 2015. These findings partially confirm our hypothesis that nutrients typically found in animal-based foods (e.g., iron, vitamin B12, calcium, vitamin D) were inversely associated with adherence to CFG.</p>
<p>Few studies have examined nutrient intake inadequacy according to adherence to the CFG-2019 recommendations. Barr (9) assessed the probability of intake inadequacy upon adherence to an eating pattern consistent with foods depicted in the CFG-2019 plate snapshot. The probability of inadequacy was near 100% for calcium and vitamin D for males and females aged 71 years or more. This result is consistent with findings in the present study, where a higher adherence to recommendations on healthy food choices was insufficient to mitigate the prevalence of inadequacy for calcium and vitamin D. The lack of specific recommendations regarding dairy foods and alternatives in CFG-2019, and consequently the absence of points in the HEFI-2019, may partly explain these findings. Among food and beverage categories contributing to the HEFI-2019, unsweetened milk had the highest correlation with intakes of calcium (r=0.56) and vitamin D (r=0.53; Supplemental Figure 1). Indeed, the main food source of calcium and vitamin D in Canadians’ diet was the “Milk &amp; Alternatives” food group in 2015 (34-36). Of note, the prevalence of inadequacy for vitamin D was very high in this sample (&gt;95%), supporting the notion that meeting vitamin D recommendations through foods alone is an important challenge (36). Similarly, data from the CCHS indicate that calcium intake inadequacy in supplement non-users increased from 58% to 68% between 2004 and 2015, respectively (35). All in all, higher adherence to CFG-2019 recommendations on food choices was insufficient to mitigate the high prevalence of inadequate calcium and vitamin D intakes. Thus, meeting calcium and vitamin D needs would require additional strategies such as specific recommendations in CFG in addition to supplementation or food fortification.</p>
<p>A review by Fernandez et al.&nbsp;highlighted potential gaps in the application of CFG-2019 recommendations, notably whether the CFG-2019 permitted the adequate consumption of nutrient-rich protein foods or not (10). Our results revealed that a higher adherence to CFG-2019 recommendations slightly reduced the low proportion of older adults with intakes below the current EAR (0.66 g/kg) and reduced by 11% and 14% the proportion of those below the hypothetical EAR of 0.8 g/kg and 1.0 g/kg. Notwithstanding, the prevalence of inadequacy for the hypothetical EAR would remain considerable, with 18% and 51% inadequate protein intakes, respectively, thus representing an additional risk factor for sarcopenia (26). Furthermore, these findings only reflect the total daily protein intake and the impact on overall protein food quality or distribution during the day is unknown. Future studies should investigate the relationship between higher adherence to CFG-2019 and overall protein food quality and should examine how to increase consumption of high-quality plant-based protein foods. In that regard, a qualitative study among older adults highlighted that health benefits and food preparation skills would facilitate consumption of plant-based protein foods (37). Increasing consumption of unsweetened soy beverage (currently zero in the present study) or unsweetened milk (mean intake of 125 ml/d; Supplemental Table 2) could also contribute to higher intake of high-quality protein. Finally, we stress that the CCHS 2015 – Nutrition excluded individuals living in institutions who likely have additional needs as well as barriers to consuming higher protein diets (14).</p>
<p>The inverse associations between the HEFI-2019 and intakes of iron, folate, and vitamin B12 also raise concerns. On one hand, the prevalence of inadequacy for these nutrients did not increase at the population level, partly because the EAR can be met at relatively low intakes for these nutrients. On the other hand, at the individual level, meeting nutrient requirements while following CFG-2019 recommendations may be more difficult in individuals at risk of inadequate intakes, e.g., older adults with loss of appetite (13, 14). Further, vitamin B12 may be particularly important for older adults and recent evidence support that food groups contribute differently at reducing risk of deficiency (38). Meeting folate requirements while following CFG may also be challenging for some individuals since refined grains, not recommended in CFG, showed the highest correlations with folate intake in the present study (Supplemental Figure 1). Indeed, non-whole grain foods are subject to mandatory fortification in Canada which is not the case of whole grain foods (39). In sum, CFG-2019 recommendations should be carefully implemented to ensure meeting nutrient intakes both at the population and individual level. Health Canada published additional information in 2022 on how to apply dietary guidelines to support health professionals and policymakers (40). The information describes the type and frequency of foods to support nutritional needs. The extent to which the additional information helps older adults shift their eating patterns to be both consistent with CFG-2019 and provide optimal nutrient intakes remains to be determined. Findings of the present study highlight that eating patterns of older adults in 2015 failed to provide optimal intakes of calcium, folate and vitamin D despite adhering to CFG-2019 recommendations thereby supporting the need for additional information, perhaps with quantitative recommendations.</p>
<p>The use of national survey data to estimate the impact of higher adherence on the prevalence of nutrient inadequacy in Canada is a strength of this study. But it must be recognized that relationships between adherence to CFG-2019 recommendations and nutrient intakes reflect the underlying eating patterns of adults 65 years or older from Canada in 2015. A variety of underlying food and beverage consumption patterns may be highly consistent with CFG-2019 recommendations yet, have diverging associations with intakes of certain nutrients. As well, eating patterns of older adults, though generally stable, may evolve over time which would result in different associations between adherence to CFG-2019 and nutrients intakes. Another key strength of this work is the use of the NCI MCMC multivariate method to account for random errors in dietary intakes measured with 24-hour recall (30, 31). Using the multivariate method permitted the joint assessment of the relationship between usual nutrient intakes and adherence to CFG-2019 recommendations on healthy food choices, as measured with the HEFI-2019, and the modelling of higher adherence to CFG-2019 recommendations compared with median adherence. Limitations must be addressed. First, self-reported dietary intakes with 24-hour dietary recall are affected by systematic errors or bias (41, 42). The working assumption that intakes are unbiased cannot be verified. Of note, we did not adjust for “misreporting status” to account for energy under-reporting in the present study. The proportion of under-reporters among older adults is not higher than in other age and sex group samples of the CCHS 2015 – Nutrition (43) and evidence indicates that diet quality based on 24-hour dietary recall may not be prone to large bias (44). Second, the food composition database, the Canadian Nutrient File 2015, may not adequately reflect the nutrient profile of foods actually consumed (45). Accordingly, estimates of prevalence of nutrient inadequacy based on self-reported dietary intakes data are not as accurate as estimates based on biomarker data. Third, our results cannot be used to extrapolate nutrient intake inadequacy at the national level. Although calcium and vitamin D supplements could contribute to reducing inadequacies (35, 36), nutrient intakes from dietary supplements were not included since the objective was to assess the relationship between nutrients and adherence to CFG-2019 recommendations on healthy food choices (4, 5, 17).</p>
<p>In conclusion, higher adherence to CFG-2019 recommendations on healthy food choices was associated with greater intakes of protein, fiber, magnesium and many nutrients considered, based on eating patterns of adults aged 65 years or more from the CCHS 2015 – Nutrition. However, higher adherence was associated with lower intakes of iron, folate, vitamin B12 and vitamin D, and not associated with calcium, zinc or vitamin A intakes, thus insufficient to mitigate dietary inadequacy in these key nutrients. Knowledge of shortfalls of CFG-2019 recommendations regarding nutrient intake inadequacy are relevant to help government, policymakers and registered dietitians in providing more comprehensive and appropriate recommendations to older adults. Our findings support the need for additional information, as that recently published by Health Canada to help ensure that eating patterns are both consistent with CFG-2019 and adequate nutrient intakes (40). Future studies should investigate how eating patterns changed after the publication of CFG-2019 and the additional information and how these changes may affect the relationship between adherence to recommendations and nutrient intakes.</p>
</section>
<section id="acknowledgments" class="level1">
<h1>Acknowledgments</h1>
<p><strong>Authors’ contributions to the manuscript</strong>: DB and SC designed the research; DB performed statistical analysis; DB wrote the first draft of the manuscript; DB and SC gave final approval and critically reviewed the manuscript.</p>
<p><strong>Sources of support</strong>: This research received no external funding.</p>
<p><strong>Conflict of Interest and Funding Disclosure</strong>: DB was a casual employee of Health Canada (2019-2020), held a doctoral training award from the Fonds de recherche du Québec – Santé (2019-2021) and holds a Canadian Institutes of Health Research (CIHR) Fellowship award (MFE-181852). SC receives research funding from the CIHR, Dairy Farmers of Canada and the Canadian Foundation for Dietetics Research. None of these agencies has funded nor was involved in this work. DB and SC have no conflicts of interest.</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ol type="1">
<li>Health Canada. Eating Well with Canada’s Food Guide. Ottawa: Health Canada, 2007:1-6.</li>
<li>Katamay SW, Esslinger KA, Vigneault M, Johnston JL, Junkins BA, Robbins LG, et al.&nbsp;Eating well with Canada’s Food Guide (2007): development of the food intake pattern. Nutr Rev 2007;65:155-66.</li>
<li>Health Canada. Food, Nutrients and Health: Interim Evidence Update 2018 for Health Professionals and Policy Makers. Ottawa: Health Canada, 2019.</li>
<li>Health Canada. Canada’s food guide. Ottawa: Health Canada, 2019.</li>
<li>Health Canada. Canada’s Dietary Guidelines - for Health Professionals and Policy Makers. 2019.</li>
<li>Brassard D, Manikpurage HD, Thériault S, Arsenault BJ, Lamarche B. Greater adherence to the 2019 Canada’s Food Guide recommendations on healthy food choices reduces the risk of cardiovascular disease in adults: a prospective analysis of UK Biobank data. Am J Clin Nutr 2022;116:1748-58.</li>
<li>Asher KE, Doucet S, Luke A. Registered dietitians’ perceptions and use of the plant-based recommendations in the 2019 Canada’s Food Guide. J Hum Nutr Diet 2021;34:715-23.</li>
<li>Barco Leme AC, Laila A, Hou S, Fisberg RM, Ma DWL, Fisberg M, et al.&nbsp;Perceptions of the 2019 Canada’s Food Guide: a qualitative study with parents from Southwestern Ontario. Appl Physiol Nutr Metab 2021.</li>
<li>Barr SI. Is the 2019 Canada’s Food Guide Snapshot nutritionally adequate? Appl Physiol Nutr Metab 2019;44:1387-90.</li>
<li>Fernandez MA, Bertolo RF, Duncan AM, Phillips SM, Elango R, Ma DWL, et al.&nbsp;Translating “protein foods” from the new Canada’s Food Guide to consumers: knowledge gaps and recommendations. Appl Physiol Nutr Metab 2020;45:1311-23.</li>
<li>Auclair O, Burgos SA. Protein consumption in Canadian habitual diets: usual intake, inadequacy, and the contribution of animal- and plant-based foods to nutrient intakes. Appl Physiol Nutr Metab 2021;46:501-10.</li>
<li>Fabek H, Sanchez-Hernandez D, Ahmed M, Marinangeli CPF, House JD, Anderson GH. An examination of contributions of animal- and plant-based dietary patterns on the nutrient quality of diets of adult Canadians. Appl Physiol Nutr Metab 2021;46:877-86.</li>
<li>Shlisky J, Bloom DE, Beaudreault AR, Tucker KL, Keller HH, Freund-Levi Y, et al.&nbsp;Nutritional Considerations for Healthy Aging and Reduction in Age-Related Chronic Disease. Adv Nutr 2017;8:17-26.</li>
<li>Remond D, Shahar DR, Gille D, Pinto P, Kachal J, Peyron MA, et al.&nbsp;Understanding the gastrointestinal tract of the elderly to develop dietary solutions that prevent malnutrition. Oncotarget 2015;6:13858-98.</li>
<li>Millen BE, Abrams S, Adams-Campbell L, Anderson CA, Brenna JT, Campbell WW, et al.&nbsp;The 2015 dietary guidelines advisory committee scientific report: development and major conclusions. Adv Nutr 2016;7:438-44.</li>
<li>Keller HH, Lengyel C, Carrier N, Slaughter SE, Morrison J, Duncan AM, et al.&nbsp;Prevalence of inadequate micronutrient intakes of Canadian long-term care residents. Br J Nutr 2018;119:1047-56.</li>
<li>Brassard D, Elvidge Munene LA, St-Pierre S, Guenther PM, Kirkpatrick SI, Slater J, et al.&nbsp;Development of the Healthy Eating Food Index (HEFI)-2019 measuring adherence to Canada’s Food Guide 2019 recommendations on healthy food choices. Appl Physiol Nutr Metab 2022;47:595-610.</li>
<li>Brassard D, Elvidge Munene LA, St-Pierre S, Gonzalez A, Guenther PM, Jessri M, et al.&nbsp;Evaluation of the Healthy Eating Food Index (HEFI)-2019 measuring adherence to Canada’s Food Guide 2019 recommendations on healthy food choices. Appl Physiol Nutr Metab 2022;47:582-94.</li>
<li>Health Canada. Reference Guide to Understanding and Using the Data: 2015 Canadian Community Health Survey - Nutrition. 2017:1-91.</li>
<li>Health Canada. Canadian Nutrient File 2015. 2023. Internet: https://food-nutrition.canada.ca/cnf-fce/index-eng.jsp (Accessed June 2023).</li>
<li>Rana H, Mallet M-C, Gonzalez A, Verreault M-F, St-Pierre S. Free Sugars Consumption in Canada. Nutrients 2021;13:1471.</li>
<li>Health Canada. Nutrition Labelling: Table of Reference Amounts for Food. Ottawa, 2016.</li>
<li>Dorrington N, Fallaize R, Hobbs DA, Weech M, Lovegrove JA. A Review of Nutritional Requirements of Adults Aged &gt;/=65 Years in the UK. J Nutr 2020;150:2245-56.</li>
<li>Otten JJ, Hellwig JP, Meyers LD. Dietary reference intakes : the essential guide to nutrient requirements. Washington, D.C.: National Academies Press, 2006.</li>
<li>Phillips SM, Chevalier S, Leidy HJ. Protein “requirements” beyond the RDA: implications for optimizing health. Appl Physiol Nutr Metab 2016;41:565-72.</li>
<li>Bauer J, Biolo G, Cederholm T, Cesari M, Cruz-Jentoft AJ, Morley JE, et al.&nbsp;Evidence-based recommendations for optimal dietary protein intake in older people: a position paper from the PROT-AGE Study Group. J Am Med Dir Assoc 2013;14:542-59.</li>
<li>Traylor DA, Gorissen SHM, Phillips SM. Perspective: Protein Requirements and Optimal Intakes in Aging: Are We Ready to Recommend More Than the Recommended Daily Allowance? Adv Nutr 2018;9:171-82.</li>
<li>Dodd KW, Guenther PM, Freedman LS, Subar AF, Kipnis V, Midthune D, et al.&nbsp;Statistical methods for estimating usual intake of nutrients and foods: a review of the theory. J Am Diet Assoc 2006;106:1640-50.</li>
<li>Thompson FE, Kirkpatrick SI, Subar AF, Reedy J, Schap TE, Wilson MM, et al.&nbsp;The National Cancer Institute’s Dietary Assessment Primer: A Resource for Diet Research. J Acad Nutr Diet 2015;115:1986-95.</li>
<li>Zhang S, Midthune D, Guenther PM, Krebs-Smith SM, Kipnis V, Dodd KW, et al.&nbsp;A New Multivariate Measurement Error Model with Zero-Inflated Dietary Data, and Its Application to Dietary Assessment. Ann Appl Stat 2011;5:1456-87.</li>
<li>Kirkpatrick SI, Guenther PM, Subar AF, Krebs-Smith SM, Herrick KA, Freedman LS, et al.&nbsp;Using short-term dietary intake data to address research questions related to usual dietary intake among populations and subpopulations: Assumptions, statistical techniques, and considerations. J Acad Nutr Diet 2022;122:1246-62.</li>
<li>Herrick KA, Rossen LM, Parsons R, Dodd KW. Estimating Usual Dietary In take From National Health and Nut rition Examination Survey Data Using the National Cancer Institute Method. Vital Health Stat 2018;2:1-63.</li>
<li>Harrell FE. General Aspects of Fitting Regression Models. Edtion ed.&nbsp;Regression Modeling Strategies: With Applications to Linear Models, Logistic and Ordinal Regression, and Survival Analysis. Cham: Springer International Publishing, 2015:13-44.</li>
<li>Vatanparast H, Islam N, Shafiee M. Consumption of Milk and alternatives decreased among Canadians from 2004 to 2015: evidence from the Canadian community health surveys. BMC Nutr 2021;7:63.</li>
<li>Vatanparast H, Islam N, Patil RP, Shafiee M, Whiting SJ. Calcium Intake from Food and Supplemental Sources Decreased in the Canadian Population from 2004 to 2015. J Nutr 2020;150:833-41.</li>
<li>Vatanparast H, Patil RP, Islam N, Shafiee M, Whiting SJ. Vitamin D Intake from Supplemental Sources but Not from Food Sources Has Increased in the Canadian Population Over Time. J Nutr 2020;150:526-35.</li>
<li>Drolet-Labelle V, Laurin D, Bedard A, Drapeau V, Desroches S. Beliefs underlying older adults’ intention to consume plant-based protein foods: A qualitative study. Appetite 2022:106346.</li>
<li>Huang HH, Cohen AA, Gaudreau P, Auray-Blais C, Allard D, Boutin M, et al.&nbsp;Vitamin B-12 Intake from Dairy But Not Meat is Associated with Decreased Risk of Low Vitamin B-12 Status and Deficiency in Older Adults from Quebec, Canada. J Nutr 2022;152:2483-92.</li>
<li>Government of Canada. Foods to which vitamins, mineral nutrients and amino acids may or must be added. 2022. Internet: https://inspection.canada.ca/food-labels/labelling/industry/nutrient-content/reference-information/eng/1389908857542/1389908896254?chap=0 (accessed June 2023).</li>
<li>Health Canada. Canada’s Dieteary Guidelines. 2022. Internet: https://food-guide.canada.ca/en/guidelines (accessed June 2023).</li>
<li>Freedman LS, Commins JM, Moler JE, Willett W, Tinker LF, Subar AF, et al.&nbsp;Pooled results from 5 validation studies of dietary self-report instruments using recovery biomarkers for potassium and sodium intake. Am J Epidemiol 2015;181:473-87.</li>
<li>Freedman LS, Commins JM, Moler JE, Arab L, Baer DJ, Kipnis V, et al.&nbsp;Pooled results from 5 validation studies of dietary self-report instruments using recovery biomarkers for energy and protein intake. Am J Epidemiol 2014;180:172-88.</li>
<li>Garriguet D. Accounting for misreporting when comparing energy intake across time in Canada. Health Rep 2018;29:3-12.</li>
<li>Kirkpatrick SI, Dodd KW, Potischman N, Zimmerman TP, Douglass D, Guenther PM, et al.&nbsp;Healthy Eating Index-2015 Scores Among Adults Based on Observed vs Recalled Dietary Intake. J Acad Nutr Diet 2021;121:2233-41 e1.</li>
<li>Satija A, Yu E, Willett WC, Hu FB. Understanding nutritional epidemiology and its role in policy. Adv Nutr 2015;6:5-18.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>